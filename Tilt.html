<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=fpjTOVmNbO4Lz34iLyptLROjXfSpIU_1TsQlCJ7q4WkfnUSgpG7o6Yx3LgtCQhIzcgkv6_KOpC-vO9QMy-VQCA);.lst-kix_list_2-6>li:before{content:"\0025cf   "}.lst-kix_list_2-7>li:before{content:"o  "}ul.lst-kix_list_1-0{list-style-type:none}.lst-kix_list_2-4>li:before{content:"o  "}.lst-kix_list_2-5>li:before{content:"\0025aa   "}.lst-kix_list_2-8>li:before{content:"\0025aa   "}ul.lst-kix_list_2-8{list-style-type:none}ul.lst-kix_list_1-3{list-style-type:none}ul.lst-kix_list_2-2{list-style-type:none}.lst-kix_list_1-0>li:before{content:"-  "}ul.lst-kix_list_1-4{list-style-type:none}ul.lst-kix_list_2-3{list-style-type:none}ul.lst-kix_list_1-1{list-style-type:none}ul.lst-kix_list_2-0{list-style-type:none}ul.lst-kix_list_1-2{list-style-type:none}ul.lst-kix_list_2-1{list-style-type:none}ul.lst-kix_list_1-7{list-style-type:none}ul.lst-kix_list_2-6{list-style-type:none}.lst-kix_list_1-1>li:before{content:"o  "}.lst-kix_list_1-2>li:before{content:"\0025aa   "}ul.lst-kix_list_1-8{list-style-type:none}ul.lst-kix_list_2-7{list-style-type:none}ul.lst-kix_list_1-5{list-style-type:none}ul.lst-kix_list_2-4{list-style-type:none}ul.lst-kix_list_1-6{list-style-type:none}ul.lst-kix_list_2-5{list-style-type:none}.lst-kix_list_1-3>li:before{content:"\0025cf   "}.lst-kix_list_1-4>li:before{content:"o  "}.lst-kix_list_1-7>li:before{content:"o  "}.lst-kix_list_1-5>li:before{content:"\0025aa   "}.lst-kix_list_1-6>li:before{content:"\0025cf   "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_list_2-0>li:before{content:"-  "}.lst-kix_list_2-1>li:before{content:"o  "}.lst-kix_list_1-8>li:before{content:"\0025aa   "}.lst-kix_list_2-2>li:before{content:"\0025aa   "}.lst-kix_list_2-3>li:before{content:"\0025cf   "}ol{margin:0;padding:0}table td,table th{padding:0}.c57{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:432.3pt;border-top-color:#000000;border-bottom-style:solid}.c45{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:531.4pt;border-top-color:#000000;border-bottom-style:solid}.c23{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:290.6pt;border-top-color:#000000;border-bottom-style:solid}.c13{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:467.5pt;border-top-color:#000000;border-bottom-style:solid}.c44{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:432.4pt;border-top-color:#000000;border-bottom-style:solid}.c39{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:176.9pt;border-top-color:#000000;border-bottom-style:solid}.c47{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:467.6pt;border-top-color:#000000;border-bottom-style:solid}.c37{padding-top:0pt;text-indent:36pt;padding-bottom:6pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c5{padding-top:12pt;padding-bottom:0pt;line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c6{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Calibri";font-style:normal}.c20{padding-top:2pt;padding-bottom:0pt;line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c24{padding-top:0pt;text-indent:36pt;padding-bottom:0pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c1{margin-left:54pt;padding-top:0pt;padding-bottom:0pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c46{padding-top:6pt;padding-bottom:6pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c32{padding-top:0pt;padding-bottom:0pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c30{padding-top:6pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c35{padding-top:12pt;padding-bottom:8pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c49{padding-top:12pt;padding-bottom:6pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c53{padding-top:12pt;padding-bottom:12pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c8{padding-top:0pt;padding-bottom:6pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c50{padding-top:0pt;padding-bottom:6pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c18{padding-top:0pt;padding-bottom:8pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c9{background-color:#c0c0c0;font-size:8pt;font-family:"Consolas";color:#a31515;font-weight:700}.c54{color:#2f5496;font-weight:400;font-size:16pt;font-family:"Calibri"}.c2{font-size:8pt;font-family:"Consolas";color:#000000;font-weight:400}.c34{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#0563c1;text-decoration:underline}.c38{margin-left:35.2pt;border-spacing:0;border-collapse:collapse;margin-right:auto}.c28{border-spacing:0;border-collapse:collapse;margin-right:auto}.c3{font-size:8pt;font-family:"Consolas";color:#a31515;font-weight:400}.c31{color:#2f5496;font-weight:400;font-size:13pt;font-family:"Calibri"}.c19{font-size:9.5pt;font-family:"Consolas";font-weight:400}.c10{font-size:8pt;font-family:"Consolas";font-weight:700}.c52{font-weight:400;font-size:8pt;font-family:"Calibri"}.c55{font-weight:700;font-size:8pt;font-family:"Calibri"}.c48{font-size:9pt;font-family:"Consolas";font-weight:400}.c16{font-size:8pt;font-family:"Consolas";font-weight:400}.c7{text-decoration:none;vertical-align:baseline;font-style:normal}.c42{font-weight:700;font-size:9pt;font-family:"Consolas"}.c43{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c51{color:inherit;text-decoration:inherit}.c14{background-color:#c0c0c0;color:#0000ff}.c21{margin-left:54pt;padding-left:0pt}.c33{text-indent:36pt;margin-right:-70.7pt}.c22{padding:0;margin:0}.c26{color:#a31515}.c25{padding-left:0pt}.c36{color:#2b91af}.c41{text-indent:36pt}.c17{background-color:#c0c0c0}.c27{color:#008000}.c56{margin-left:36pt}.c11{color:#000000}.c12{height:0pt}.c15{color:#0000ff}.c40{background-color:#e7e6e6}.c29{margin-left:54pt}.c4{height:11pt}.title{padding-top:24pt;color:#000000;font-weight:700;font-size:36pt;padding-bottom:6pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:18pt;color:#666666;font-size:24pt;padding-bottom:4pt;font-family:"Georgia";line-height:1.0791666666666666;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Calibri"}p{margin:0;color:#000000;font-size:11pt;font-family:"Calibri"}h1{padding-top:12pt;color:#2f5496;font-size:16pt;padding-bottom:0pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:2pt;color:#2f5496;font-size:13pt;padding-bottom:0pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:14pt;color:#000000;font-weight:700;font-size:14pt;padding-bottom:4pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:12pt;color:#000000;font-weight:700;font-size:12pt;padding-bottom:2pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:11pt;color:#000000;font-weight:700;font-size:11pt;padding-bottom:2pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:10pt;color:#000000;font-weight:700;font-size:10pt;padding-bottom:2pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}</style></head><body class="c43 doc-content"><h1 class="c5"><span class="c7 c54">Tilt</span></h1><p class="c18"><span class="c6">The P3 SDK can keep track of tilt warnings and notify when the number of tilt warnings is exceeded. The actual tilt processing is the responsibility of the application.</span></p><p class="c18"><span class="c6">Tilt handling is absent from P3SampleApp. This tech tip shows how to implement tilt in P3SampleApp.</span></p><p class="c18"><span>For more information on fixing a sensitive tilt, consult this </span><span class="c34"><a class="c51" href="SensitiveTilt.html">other tech tip</a></span><span class="c6">&nbsp;in the owner&rsquo;s series.</span></p><h2 class="c20"><span class="c7 c31">SDK Documentation</span></h2><p class="c18"><span>Tilt handling is documented in </span><span class="c34">file:///C:/p3/P3_SDK_V0.8/P3SampleApp/Documentation/html/_customizing_your_game.html#Tilt</span></p><p class="c18"><span>Some tilt options are documented in </span><span class="c34">file:///C:/p3/P3_SDK_V0.8/P3SampleApp/Documentation/html/_game_management.html#DisablingTiltHandling</span><span class="c6">&nbsp;</span></p><p class="c18"><span>The Tilt settings in the service menu are documented in </span><span class="c34">file:///C:/p3/P3_SDK_V0.8/P3SampleApp/Documentation/html/_persistent_data.html#TiltGameAttributes</span><span class="c6">&nbsp;</span></p><h2 class="c20"><span class="c31 c7">Requirements</span></h2><p class="c18"><span class="c6">There are many requirements when implementing tilt. Some are easy, some can be quite complex. From experience, the interaction between tilt drainage and ball search can be tricky.</span></p><p class="c18"><span class="c6">Tilt warnings must give feedback:</span></p><ul class="c22 lst-kix_list_2-0 start"><li class="c1 c25 li-bullet-0"><span class="c6">Play a tilt warning specific sound (optional)</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Display a tilt warning message on the screen</span></li><li class="c18 c21 li-bullet-0"><span class="c6">Display remaining number of tilt warnings on the screen (optional)</span></li></ul><p class="c18"><span class="c6">Tilt needs to stop all interactions:</span></p><ul class="c22 lst-kix_list_1-0 start"><li class="c1 c25 li-bullet-0"><span class="c6">Disable flippers</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Disable slings and bumpers</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Disable side targets</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Turn off all LEDs and GUIInserts</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Turn off all audio currently playing (sounds and music) and the sound queue</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Turn off all videos currently playing (like intros or movie clips) and the video queue</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Remove all popups on the screen (button legend, floating popups)</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Stop anything continuously updated on the screen like timers</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Stop the ball saver and respawns (i.e. virtual kickbacks)</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Turn off the topper</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Ignore all target switch events and BallPath shot events</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Ignore all scoring</span></li><li class="c18 c21 li-bullet-0"><span class="c6">Stop delayed handlers that could reactivate a feature</span></li></ul><p class="c18"><span class="c6">Tilt needs to give feedback the player has tilted:</span></p><ul class="c22 lst-kix_list_1-0"><li class="c1 c25 li-bullet-0"><span class="c6">Play a tilt specific sound (optional)</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Display a tilt message on the screen</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Launch the ball if initial launch is pending (optional but a good indication the ball was forfeited)</span></li><li class="c18 c21 li-bullet-0"><span class="c6">Launch the ball if currently held by a mode (e.g. Weird Al Ticket Counter or Supply Closet)</span></li></ul><p class="c18"><span class="c6">Tilt needs to advance the game to the next ball:</span></p><ul class="c22 lst-kix_list_1-0"><li class="c1 c25 li-bullet-0"><span class="c6">Relaunch balls falling in holes and other locks</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Release balls already in physical locks (optional, depends on game rules)</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Raise the upper flippers in case a ball is locked behind (optional, faster than ball search)</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Drop raised scoops and walls (optional, faster than ball search)</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Ignore multiball drains until only one ball in play</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Block pending multiball launches (except if no ball in play yet)</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Run ball search if nothing happens for a while</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Detect when last ball drains</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Skip bonus or show bonus with penalty</span></li><li class="c1 c25 li-bullet-0"><span class="c6">Wait until the tilt bob settles before moving to the next ball</span></li><li class="c18 c21 li-bullet-0"><span class="c6">Replenish the number of tilt warnings if the game rules allow it</span></li></ul><h2 class="c20"><span class="c31 c7">Tilt Detection</span></h2><p class="c18"><span class="c6">A tilt is detected by the tilt bob when it contacts the ring surrounding it. This corresponds to the tilt switch becoming active.</span></p><p class="c32"><span class="c6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public bool sw_tilt_active(Switch sw)</span></p><p class="c32"><span class="c6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p class="c32"><span class="c6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&hellip;</span></p><p class="c32"><span class="c6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return SWITCH_CONTINUE;</span></p><p class="c18"><span class="c6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c18"><span class="c6">You don&rsquo;t need to implement this switch event handler since the P3 SDK takes care of it.</span></p><p class="c18"><span class="c6">In theory, a tilt could also be detected by the accelerometer but that&rsquo;s not readily available in the P3 SDK.</span></p><h2 class="c20"><span class="c31 c7">Tilt Settings</span></h2><p class="c18"><span class="c6">The P3 SDK implements 5 tilt settings that are inherited by all applications.</span></p><p class="c18"><span class="c6">To access the tilt settings, make sure your application is running, open the coin door and press the Launch button. Close the coin door, then select Settings &gt; Mechs &gt; Tilt.</span></p><p class="c32"><span class="c6">To enable tilt detection, set both &ldquo;Tilt Detection Enabled&rdquo; and &ldquo;Use tilt bob for tilt detection&rdquo; to true.</span></p><p class="c18"><span class="c6">To disable tilt detection, set &ldquo;Tilt Detection Enabled&rdquo; to false. </span></p><p class="c50"><span class="c6">The reason why there are two settings is because there are two ways to detect a tilt:</span></p><ul class="c22 lst-kix_list_1-0"><li class="c1 c25 li-bullet-0"><span class="c6">when the tilt bob sways too much and hits the surrounding ring</span></li><li class="c18 c21 li-bullet-0"><span class="c6">or when the application sends a custom tilt event programmatically</span></li></ul><p class="c18"><span class="c6">In practice, the current applications do not send custom tilt events, so the two settings are somewhat redundant.</span></p><a id="t.297d1f80f2fd74f9bd343824a1b5e5f0e785be86"></a><a id="t.0"></a><table class="c28"><tr class="c12"><td class="c39 c40" colspan="1" rowspan="1"><p class="c0"><span class="c6">Setting</span></p></td><td class="c23 c40" colspan="1" rowspan="1"><p class="c0"><span class="c6">Description</span></p></td></tr><tr class="c12"><td class="c39" colspan="1" rowspan="1"><p class="c0"><span class="c6">Tilt Detection Enabled</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c0"><span class="c6">when true: enables custom programmatic tilt events, also allows &ldquo;Use tilt bob for tilt detection&rdquo; to control tilt bob detection;</span></p><p class="c0"><span class="c6">when false: disables all tilt detection</span></p></td></tr><tr class="c12"><td class="c39" colspan="1" rowspan="1"><p class="c0"><span class="c6">Use tilt bob for tilt detection</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c0"><span class="c6">when true: enables tilt bob detection if and only if &ldquo;Tilt Detection Enabled&rdquo; is also true;</span></p><p class="c0"><span class="c6">when false: disables tilt bob detection</span></p></td></tr><tr class="c12"><td class="c39" colspan="1" rowspan="1"><p class="c0"><span class="c6">Tilt Warnings</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c0"><span class="c6">Number of tilt warnings before a tilt is detected</span></p></td></tr><tr class="c12"><td class="c39" colspan="1" rowspan="1"><p class="c0"><span class="c6">Time (in seconds) between warning</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c0"><span class="c6">Period of time after a tilt warning during which tilt handling is temporarily disabled</span></p></td></tr><tr class="c12"><td class="c39" colspan="1" rowspan="1"><p class="c0"><span class="c6">Settle time (in seconds) after tilt</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c0"><span class="c6">Period of time after tilt before the next player can start his ball, this gives time for the tilt bob to settle.</span></p></td></tr></table><p class="c18 c4"><span class="c6"></span></p><p class="c18"><span class="c6">There is also the setting &ldquo;Tilt Sensitivity Popups&rdquo; under Settings &gt; Gameplay &gt; Debug. The SDK does not use that setting, it is up to the application to do something with it. Heist and WAMONH ignore it, so you can ignore it too.</span></p><h2 class="c20"><span class="c31 c7">TripleTargetsMode</span></h2><p class="c18"><span class="c6">TripleTargetsMode is worth mentioning here because it shows an anti-pattern. It implements a switch handler directly instead of relying on mode events sent by the module driver.</span></p><p class="c18"><span class="c6">The big advantage with events is the application no longer has to figure out which switches can be ignored versus those that must be processed during tilt drainage (for mechs and ball search).</span></p><p class="c18"><span class="c6">This advice applies to switches in the module definition file. The application might still have to implement switch event handlers for some switches in the base machine. The drain switch is a good example of that.</span></p><p class="c18"><span class="c6">We will not show how to fix TripleTargetsMode because it is not used in P3SampleApp. It is simpler to just delete the source file.</span></p><h2 class="c20"><span class="c31 c7">TiltMode</span></h2><p class="c18"><span class="c6">TiltMode is part of the SDK. This mode keeps track of the number of tilt warnings. An instance of TiltMode is created by BaseGameMode.</span></p><p class="c18"><span class="c6">By default, TiltMode is added to the ModeQueue in StartNewBall(). To override this, set the bool member variable tiltModeEnabled to false in your BaseGameMode subclass. This will let you create your own implementation of TiltMode as well as control when TiltMode is added to the ModeQueue. Typically, the BaseGameMode subclass does not modify tiltModeEnabled because TiltMode works fine.</span></p><p class="c18"><span class="c6">TiltMode is designed to remain in the ModeQueue until the next ball starts. The application controls when tilt handling is enabled during that time. The application programmatically enables TiltMode when the ball starts, and disables TiltMode when the bonus is displayed. To accomplish this, it sends the Evt_EnableTilt event.</span></p><p class="c18 c33"><span class="c6">PostModeEventToModes(&quot;Evt_EnableTilt&quot;, true); &nbsp;// enables tilt detection if the settings allow it</span></p><p class="c18 c41"><span class="c6">PostModeEventToModes(&quot;Evt_EnableTilt&quot;, false); // disables tilt detection</span></p><p class="c18"><span class="c6">If a tilt is detected and the number of tilt warnings was not exceeded, then TiltMode sends Evt_TiltWarning to the GUI and the modes. Tilt detection is temporarily disabled for &ldquo;Time (in seconds) between warnings&rdquo;. The event data is the number of warnings detected, so this number goes up with each warning.</span></p><p class="c32"><span class="c6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PostModeEventToGUI(&quot;Evt_TiltWarning&quot;, warningCount);</span></p><p class="c18"><span class="c6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PostModeEventToModes(&quot;Evt_TiltWarning&quot;, warningCount);</span></p><p class="c18"><span class="c6">Let&rsquo;s put it all together: a tilt is detected if the tilt switch is active, both &ldquo;Tilt Detection Enabled&rdquo; and &ldquo;Use tilt bob for tilt detection&rdquo; are enabled, the application enabled TiltMode programmatically and there was no recent tilt warning (less than &ldquo;Time (in seconds) between warnings&rdquo; ago).</span></p><p class="c18"><span class="c6">If a tilt is detected and the number of tilt warnings is exceeded, then TiltMode sends Evt_Tilted to the modes and it immediately disables itself. The event data is always 0 so it can be ignored. The application is responsible to finish tilt processing, including the tilt settle time. The Evt_Tilted event is not sent to the GUI, that&rsquo;s also the responsibility of the application if it wants some visual feedback.</span></p><p class="c18 c41"><span class="c6">PostModeEventToModes(&quot;Evt_Tilted&quot;, 0); </span></p><p class="c18"><span class="c6">When we say P3SampleApp does not implement tilt processing, we mean it does not handle the Evt_TiltWarning and Evt_Tilted events.</span></p><p class="c18"><span class="c6">The application can send the event Evt_ResetTiltWarnings to reset the tilt warning count back to zero. This is rarely used since the warning count is reset to 0 when TiltMode starts, i.e. with every new ball. By definition, a tilt ends the ball and that leads to a new ball. I wish the event data was the new tilt warning count, but unfortunately, the event data is ignored.</span></p><p class="c18 c41"><span class="c6">PostModeEventToModes(&quot;Evt_ResetTiltWarnings&quot;, 0);</span></p><p class="c18"><span class="c6">TiltMode also handles custom tilt events sent by the application. It&rsquo;s unlikely your application will need these events. We only mention them for completion and to justify the two tilt settings.</span></p><p class="c18 c56"><span class="c6">Sending the event Evt_NonStandardTiltWarning causes a tilt detection similar to the tilt bob hitting the ring.</span></p><p class="c18 c56"><span class="c6">Sending the event Evt_NonStandardTilt causes an immediate tilt similar to a tilt detection exceeding the number of tilt warnings.</span></p><p class="c18"><span class="c6">The event data is ignored for both of these events.</span></p><h2 class="c20"><span class="c31 c7">BaseGameMode</span></h2><p class="c18"><span class="c6">BaseGameMode is also part of the SDK. This mode implements an event handler for Evt_Tilted. The handler simply sets a flag to remember the ball is tilting. This will block the display of the bonus in the Evt_BallEnded event handler. See the section &ldquo;showBonusIfTiltActive&rdquo; below if you want to show the bonus even if the ball has tilted.</span></p><h2 class="c20"><span class="c31 c7">P3SABaseGameMode</span></h2><p class="c18"><span class="c6">P3SABaseGameMode is the mode that enables and disables TiltMode programmatically.</span></p><p class="c18"><span class="c6">Edit Assets\Scripts\Modes\P3SABaseGameMode.cs and insert the lines in bold:</span></p><a id="t.d1634a827efed450477434993883f2191a7602e5"></a><a id="t.1"></a><table class="c28"><tr class="c12"><td class="c47" colspan="1" rowspan="1"><p class="c30"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protected override void StartNewBall()</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base.StartNewBall();</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p3.AddMode(homeMode);</span></p><p class="c0"><span class="c16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c10 c17">PostModeEventToModes(&quot;Evt_EnableTilt&quot;, true);</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// ##########################################</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// # Ball End</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// ##########################################</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Wait for an event from the active game mode signalling the ball is over.</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protected override bool BallEndedEventHandler(string eventName, object eventData)</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p class="c0"><span class="c16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c10 c17">PostModeEventToModes(&quot;Evt_EnableTilt&quot;, false);</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!forcePlayerChangeActive)</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Reset scoring multiplier before applying bonus.</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ScoreManager.SetX (1);</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bonusInfo = homeMode.getBonusInfo();</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c10 c17">if (tilting) {</span></p><p class="c0"><span class="c10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c10 c17">PostModeEventToGUI(&quot;Evt_TiltComplete&quot;, null);</span></p><p class="c0"><span class="c10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c10 c17">}</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return base.BallEndedEventHandler(eventName, eventData);</span></p><p class="c8"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p></td></tr></table><p class="c35"><span class="c6">It is now possible to tilt when the ball is waiting to be launched or during play, whereas it is not possible to tilt during the bonus display.</span></p><p class="c35"><span class="c6">The Evt_TiltComplete event is sent to the GUI to remove tilt feedback on the screen. This event is sent when all balls have drained but before the bonus would be displayed.</span></p><h2 class="c20"><span class="c31 c7">P3SAPriorities</span></h2><p class="c18"><span class="c6">Edit Assets\Scripts\Modes\P3SAPriorities.cs to add a constant required in the next section.</span></p><a id="t.7cc6e013717f5065973ce999f300c505ee1ec4a8"></a><a id="t.2"></a><table class="c28"><tr class="c12"><td class="c13" colspan="1" rowspan="1"><p class="c30"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; public const int PRIORITY_MOVING_TARGET = PRIORITY_HOME + 60;</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; public const int PRIORITY_BLACKOUT_LED_SHOW = PRIORITY_HOME + 399;</span></p><p class="c8"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">public const int PRIORITY_TILTED = PRIORITY_HOME + 1000;</span></p></td></tr></table><p class="c18 c4"><span class="c6"></span></p><h2 class="c20"><span class="c31 c7">TiltedMode</span></h2><p class="c18"><span class="c6">TiltedMode is the new mode that disables everything when a tilt is detected. Do not confuse the application&rsquo;s TiltedMode with the SDK&rsquo;s TiltMode.</span></p><p class="c18"><span class="c6">Create the file Assets\Scripts\Modes\Mechs\TiltedMode.cs with this content:</span></p><a id="t.285c620141c9601bb91f19788855053b4cfcd605"></a><a id="t.3"></a><table class="c28"><tr class="c12"><td class="c13" colspan="1" rowspan="1"><p class="c30"><span class="c16 c15">using</span><span class="c2 c7">&nbsp;Multimorphic.NetProc;</span></p><p class="c0"><span class="c16 c15">using</span><span class="c2 c7">&nbsp;Multimorphic.NetProcMachine.Config;</span></p><p class="c0"><span class="c16 c15">using</span><span class="c2 c7">&nbsp;Multimorphic.NetProcMachine.Machine;</span></p><p class="c0"><span class="c16 c15">using</span><span class="c2 c7">&nbsp;Multimorphic.P3;</span></p><p class="c0"><span class="c16 c15">using</span><span class="c2 c7">&nbsp;Multimorphic.P3.Colors;</span></p><p class="c0"><span class="c16 c15">using</span><span class="c2 c7">&nbsp;Multimorphic.P3.Mechs;</span></p><p class="c0"><span class="c16 c15">using</span><span class="c2 c7">&nbsp;Multimorphic.P3App.Logging;</span></p><p class="c0"><span class="c16 c15">using</span><span class="c2 c7">&nbsp;Multimorphic.P3App.Modes;</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c16 c15">namespace</span><span class="c2 c7">&nbsp;Multimorphic.P3SA.Modes</span></p><p class="c0"><span class="c2 c7">{</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; </span><span class="c16 c15">public</span><span class="c2">&nbsp;</span><span class="c16 c15">class</span><span class="c2">&nbsp;</span><span class="c16 c36">TiltedMode</span><span class="c2 c7">&nbsp;: P3SAGameMode</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">private</span><span class="c2">&nbsp;</span><span class="c16 c15">static</span><span class="c2">&nbsp;</span><span class="c16 c15">string</span><span class="c2">[] switches = { </span><span class="c3">&quot;slingL&quot;</span><span class="c2">, </span><span class="c3">&quot;slingR&quot;</span><span class="c2">, </span><span class="c3">&quot;buttonLeft0&quot;</span><span class="c2">, </span><span class="c3">&quot;buttonLeft1&quot;</span><span class="c2">, </span><span class="c3">&quot;buttonLeft2&quot;</span><span class="c2">, </span><span class="c3">&quot;buttonRight0&quot;</span><span class="c2">, </span><span class="c3">&quot;buttonRight1&quot;</span><span class="c2">, </span><span class="c3">&quot;buttonRight2&quot;</span><span class="c2 c7">&nbsp;};</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">public</span><span class="c2">&nbsp;TiltedMode(P3Controller controller, </span><span class="c16 c15">int</span><span class="c2 c7">&nbsp;priority)</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : </span><span class="c16 c15">base</span><span class="c2 c7">(controller, priority)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">public</span><span class="c2">&nbsp;</span><span class="c16 c15">override</span><span class="c2">&nbsp;</span><span class="c16 c15">void</span><span class="c2 c7">&nbsp;mode_started()</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">base</span><span class="c2 c7">.mode_started();</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">for</span><span class="c2">&nbsp;(</span><span class="c16 c15">int</span><span class="c2 c7">&nbsp;i = 0; i &lt; LEDScripts.Count; i++)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LEDScripts[i] = LEDHelpers.OnLED(p3, LEDScripts[i], Color.black);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">for</span><span class="c2">&nbsp;(</span><span class="c16 c15">int</span><span class="c2 c7">&nbsp;j = 0; j &lt; GUIInsertScripts.Count; j++)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GUIInsertScripts[j] = GUIInsertHelpers.OnInsert(p3, GUIInsertScripts[j], Color.black);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PostModeEventToModes(</span><span class="c3">&quot;Evt_EnableLanes&quot;</span><span class="c2">, </span><span class="c16 c15">false</span><span class="c2 c7">);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PostModeEventToModes(</span><span class="c3">&quot;Evt_EnableFlippers&quot;</span><span class="c2">, </span><span class="c16 c15">false</span><span class="c2 c7">);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PostModeEventToModes(</span><span class="c3">&quot;Evt_EnableBumpers&quot;</span><span class="c2">, </span><span class="c16 c15">false</span><span class="c2 c7">);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PostModeEventToModes(</span><span class="c3">&quot;Evt_BallSaveStop&quot;</span><span class="c2">, </span><span class="c16 c15">null</span><span class="c2 c7">);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PostModeEventToModes(</span><span class="c3">&quot;Evt_RespawnEnable&quot;</span><span class="c2">, </span><span class="c16 c15">false</span><span class="c2 c7">);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PostModeEventToModes(</span><span class="c3">&quot;Evt_AlTopperStop&quot;</span><span class="c2 c7">, 0);</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RequestPlaylist(</span><span class="c3">&quot;Silence&quot;</span><span class="c2 c7">);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RaiseUpperFlippers();</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p3.wallScoopMode.LowerWalls(WallScoopSequence.Simultaneously);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p3.wallScoopMode.LowerScoops(WallScoopSequence.Simultaneously);</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AddModeEventHandler(</span><span class="c3">&quot;Evt_ScoopHit&quot;</span><span class="c2 c7">, HoleEventHandler, Priority);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AddModeEventHandler(</span><span class="c3">&quot;Grid Event&quot;</span><span class="c2 c7">, BlockEventHandler, Priority);</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">foreach</span><span class="c2">&nbsp;(</span><span class="c16 c15">string</span><span class="c2">&nbsp;switchName </span><span class="c16 c15">in</span><span class="c2 c7">&nbsp;switches)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add_switch_handler(switchName, </span><span class="c3">&quot;inactive&quot;</span><span class="c2 c7">, 0, BlockSwitchHandler);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add_switch_handler(switchName, </span><span class="c3">&quot;active&quot;</span><span class="c2 c7">, 0, BlockSwitchHandler);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">foreach</span><span class="c2">&nbsp;(BallPathDefinition ballPath </span><span class="c16 c15">in</span><span class="c2 c7">&nbsp;p3.BallPaths.Values)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">if</span><span class="c2 c7">&nbsp;(ballPath.ExitType == BallPathExitType.Target &amp;&amp;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ballPath.CompletedEvent.Contains(</span><span class="c3">&quot;_inactive&quot;</span><span class="c2 c7">))</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c27">// format of switch event must be &quot;sw_&lt;switch name&gt;_active&quot; for started events</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">string</span><span class="c2">[] strippedSwitchName = ballPath.CompletedEvent.Split(</span><span class="c3">&#39;_&#39;</span><span class="c2 c7">);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">string</span><span class="c2 c7">&nbsp;swName = strippedSwitchName[1];</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add_switch_handler(swName, </span><span class="c3">&quot;inactive&quot;</span><span class="c2 c7">, 0, BlockSwitchHandler);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add_switch_handler(swName, </span><span class="c3">&quot;active&quot;</span><span class="c2 c7">, 0, BlockSwitchHandler);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c27">// also register event handlers below</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AddModeEventHandler(ballPath.StartedEvent, BlockEventHandler, Priority);</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">if</span><span class="c2 c7">&nbsp;(ballPath.ExitType == BallPathExitType.Hole)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AddModeEventHandler(ballPath.CompletedEvent, HoleEventHandler, Priority);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">else</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AddModeEventHandler(ballPath.CompletedEvent, BlockEventHandler, Priority);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">public</span><span class="c2">&nbsp;</span><span class="c16 c15">override</span><span class="c2">&nbsp;</span><span class="c16 c15">void</span><span class="c2 c7">&nbsp;mode_stopped()</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RemovePlaylistRequests();</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DropUpperFlippers();</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">base</span><span class="c2 c7">.mode_stopped();</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">private</span><span class="c2">&nbsp;</span><span class="c16 c15">bool</span><span class="c2 c7">&nbsp;BlockSwitchHandler(Switch sw)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">return</span><span class="c2 c7">&nbsp;SWITCH_STOP;</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">private</span><span class="c2">&nbsp;</span><span class="c16 c15">bool</span><span class="c2">&nbsp;BlockEventHandler(</span><span class="c16 c15">string</span><span class="c2">&nbsp;evtName, </span><span class="c16 c15">object</span><span class="c2 c7">&nbsp;evtData)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">return</span><span class="c2 c7">&nbsp;EVENT_STOP;</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">private</span><span class="c2">&nbsp;</span><span class="c16 c15">bool</span><span class="c2">&nbsp;HoleEventHandler(</span><span class="c16 c15">string</span><span class="c2">&nbsp;evtName, </span><span class="c16 c15">object</span><span class="c2 c7">&nbsp;evtData)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; P3SABallLauncher.launch();</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">return</span><span class="c2 c7">&nbsp;EVENT_STOP;</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">private</span><span class="c2">&nbsp;</span><span class="c16 c15">void</span><span class="c2 c7">&nbsp;RaiseUpperFlippers()</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RaiseUpperLeftFlipper();</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c27">// Raise Upper Right Flipper after a small delay</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; delay(</span><span class="c3">&quot;RaiseUpperRightFlipper&quot;</span><span class="c2">, EventType.None, 0.25, </span><span class="c16 c15">new</span><span class="c2 c7">&nbsp;Multimorphic.P3.VoidDelegateNoArgs(RaiseUpperRightFlipper));</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">private</span><span class="c2">&nbsp;</span><span class="c16 c15">void</span><span class="c2 c7">&nbsp;RaiseUpperLeftFlipper()</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p3.Coils[</span><span class="c3">&quot;auxLeft0&quot;</span><span class="c2 c7">].Pulse(30);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p3.Coils[</span><span class="c3">&quot;auxLeft1&quot;</span><span class="c2 c7">].Pulse(0);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">private</span><span class="c2">&nbsp;</span><span class="c16 c15">void</span><span class="c2 c7">&nbsp;RaiseUpperRightFlipper()</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p3.Coils[</span><span class="c3">&quot;auxRight0&quot;</span><span class="c2 c7">].Pulse(30);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p3.Coils[</span><span class="c3">&quot;auxRight1&quot;</span><span class="c2 c7">].Pulse(0);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">private</span><span class="c2">&nbsp;</span><span class="c16 c15">void</span><span class="c2 c7">&nbsp;DropUpperFlippers()</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cancel_delayed(</span><span class="c3">&quot;RaiseUpperRightFlipper&quot;</span><span class="c2 c7">);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p3.Coils[</span><span class="c3">&quot;auxLeft1&quot;</span><span class="c2 c7">].Disable();</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p3.Coils[</span><span class="c3">&quot;auxRight1&quot;</span><span class="c2 c7">].Disable();</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; }</span></p><p class="c8"><span class="c2 c7">}</span></p></td></tr></table><p class="c18 c4"><span class="c6"></span></p><h2 class="c20"><span class="c31 c7">HomeMode</span></h2><p class="c18"><span class="c6">Edit Assets\Scripts\Modes\SceneModes\HomeMode.cs</span></p><p class="c18"><span class="c6">Add these declarations at the top of the class:</span></p><a id="t.4a89ebcf386a6c158d2852d052b5eef4d6e5790b"></a><a id="t.4"></a><table class="c28"><tr class="c12"><td class="c45" colspan="1" rowspan="1"><p class="c30"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; private LanesMode lanesMode;</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; private P3SAGameMode modeSummaryPendingMode;</span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">private TiltedMode tiltedMode;</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; // Declare TwitchControlMode to handle twitch viewer interactions</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; private TwitchControlMode twitchControlMode;</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; private bool firstTimePerBall;</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; private int scoreX;</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; private int lastBallNum;</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; private bool ballStarted;</span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">private bool isBallDrained;</span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">private bool isTiltActive;</span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">private bool isTiltSettled;</span></p><p class="c8"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; ...</span></p></td></tr></table><p class="c18 c4"><span class="c6"></span></p><p class="c18"><span class="c6">Create the tiltedMode instance in the constructor:</span></p><a id="t.8967d01d6f9ed71c59381a90bab7fb02f88b900c"></a><a id="t.5"></a><table class="c28"><tr class="c12"><td class="c45" colspan="1" rowspan="1"><p class="c30"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; movingTargetMode = new MovingTargetMode (p3, P3SAPriorities.PRIORITY_MOVING_TARGET);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sideTargetMode = new SideTargetMode (p3, P3SAPriorities.PRIORITY_SIDE_TARGET);</span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">tiltedMode = new TiltedMode(p3, P3SAPriorities.PRIORITY_TILTED);</span></p><p class="c8"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p></td></tr></table><p class="c18 c4"><span class="c6"></span></p><p class="c18"><span class="c6">Add some event handlers in the constructor:</span></p><a id="t.2defbd71022b2f4e730a8c732d6b200373a20c9f"></a><a id="t.6"></a><table class="c28"><tr class="c12"><td class="c45" colspan="1" rowspan="1"><p class="c30"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AddModeEventHandler(&quot;Evt_ScoopHit&quot;, ScoopEventHandler, Priority);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AddModeEventHandler(&quot;Evt_BallSearchBallLaunchRequest&quot;, BallSearchBallLaunchRequestEventHandler, Priority);</span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">AddModeEventHandler(&quot;Evt_TiltWarning&quot;, TiltWarningEventHandler, Priority);</span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">AddModeEventHandler(&quot;Evt_Tilted&quot;, TiltedEventHandler, Priority);</span></p><p class="c8"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p></td></tr></table><p class="c18 c4"><span class="c6"></span></p><p class="c18"><span class="c6">Initialize some variables in mode_started():</span></p><a id="t.683e10e3ef4a9a0369f9ca3462b01c90164954f4"></a><a id="t.7"></a><table class="c28"><tr class="c12"><td class="c13" colspan="1" rowspan="1"><p class="c30"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; firstTimePerBall = true;</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ballStarted = false;</span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">isBallDrained = false;</span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">isTiltActive = false;</span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">isTiltSettled = true;</span></p><p class="c8"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p></td></tr></table><p class="c18 c4"><span class="c6"></span></p><p class="c18"><span class="c6">Remove tiltedMode in mode_stopped():</span></p><a id="t.d9785f3d639b80324e80210f0317963824f4fe4f"></a><a id="t.8"></a><table class="c28"><tr class="c12"><td class="c13" colspan="1" rowspan="1"><p class="c30"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p3.RemoveMode (movingTargetMode);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p3.RemoveMode (sideTargetMode);</span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">p3.RemoveMode (tiltedMode);</span></p><p class="c8"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p></td></tr></table><p class="c18 c4"><span class="c6"></span></p><p class="c18"><span class="c6">Edit the sw_drain_active() method like this:</span></p><a id="t.fe5d5ec6165dac2744dfb3614cc477b2790e56b8"></a><a id="t.9"></a><table class="c28"><tr class="c12"><td class="c13" colspan="1" rowspan="1"><p class="c30"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; public bool sw_drain_active(Switch sw)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Multimorphic.P3App.Logging.Logger.Log(Multimorphic.P3App.Logging.LogCategories.Game, &quot;HomeMode has received a drain event.&quot;);</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">if (ballStarted || isTiltActive)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">isBallDrained = true;</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">if (isTiltSettled)</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">{</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">EndOfBall();</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">}</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Multimorphic.P3App.Logging.Logger.Log(</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Multimorphic.P3App.Logging.LogCategories.Game,</span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;Ball drained, but we&#39;re not processing it because </span><span class="c10 c17">ballStarted=&quot; + ballStarted + &quot; and isTiltActive=&quot; + isTiltActive</span><span class="c2 c7">);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return SWITCH_CONTINUE;</span></p><p class="c8"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p></td></tr></table><p class="c35"><span class="c6">Notice how sw_drain_active() is careful not to end the ball right away if the ball has tilted and the tilt bob has not settled yet. We don&rsquo;t want to penalize the next player for a violent tilt by the preceding player.</span></p><p class="c18"><span class="c6">Send Evt_BallDrained in EndOfBall():</span></p><a id="t.027e14c5cc371a5aeb5a6d6b5f9fad8b867b459e"></a><a id="t.10"></a><table class="c28"><tr class="c12"><td class="c13" colspan="1" rowspan="1"><p class="c30"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; private void EndOfBall()</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">PostModeEventToModes(&quot;Evt_BallDrained&quot;, 0);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ballStarted = false;</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p></td></tr></table><p class="c18 c4"><span class="c6"></span></p><p class="c18"><span class="c6">Add some new event handler methods at the end of the class. Since TiltMode does not send the Evt_Tilted event to the GUI, the application reposts the event to the GUI in TiltedEventHandler.</span></p><a id="t.23de172297cd2018f9ba7e86b72ac14f8f60fec4"></a><a id="t.11"></a><table class="c28"><tr class="c12"><td class="c13" colspan="1" rowspan="1"><p class="c30"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c15">private</span><span class="c10 c11">&nbsp;</span><span class="c10 c15">bool</span><span class="c10 c11">&nbsp;TiltWarningEventHandler(</span><span class="c10 c15">string</span><span class="c10 c11">&nbsp;eventName, </span><span class="c10 c15">object</span><span class="c10 c7 c11">&nbsp;eventData)</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c27">// int warningNumber = (int)eventData;</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c27">// PlaySound(&quot;TiltWarningSound&quot;);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c27">// PlaySound(&quot;TiltWarningVoiceMessage&quot;);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c15">return</span><span class="c10 c7 c11">&nbsp;EVENT_CONTINUE;</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c10 c7 c11"></span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c15">private</span><span class="c10 c11">&nbsp;</span><span class="c10 c15">bool</span><span class="c10 c11">&nbsp;TiltedEventHandler(</span><span class="c10 c15">string</span><span class="c10 c11">&nbsp;eventName, </span><span class="c10 c15">object</span><span class="c10 c7 c11">&nbsp;eventData)</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isTiltActive = </span><span class="c10 c15">true</span><span class="c10 c7 c11">;</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isTiltSettled = </span><span class="c10 c15">false</span><span class="c10 c7 c11">;</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AddModeEventHandler(</span><span class="c10 c26">&quot;Evt_TiltSettled&quot;</span><span class="c10 c7 c11">, TiltSettledEventHandler, Priority);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PostModeEventToGUI(</span><span class="c10 c26">&quot;Evt_Tilted&quot;</span><span class="c10 c11">, </span><span class="c10 c15">null</span><span class="c10 c7 c11">);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c27">// PlaySound(&quot;TiltSound&quot;);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c27">// PlaySound(&quot;TiltVoiceMessage&quot;);</span></p><p class="c0 c4"><span class="c10 c7 c11"></span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c15">base</span><span class="c10 c7 c11">.p3.AddMode(tiltedMode);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c15">if</span><span class="c10 c7 c11">&nbsp;(!ballStarted)</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PostModeEventToGUI(</span><span class="c10 c26">&quot;Evt_HideButtonLegend&quot;</span><span class="c10 c7 c11">, 0);</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ballStartMode.Disable();</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; P3SABallLauncher.launch();</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c10 c7 c11"></span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PostModeEventToModes(</span><span class="c10 c26">&quot;Evt_TiltProcess&quot;</span><span class="c10 c11">, </span><span class="c10 c15">null</span><span class="c10 c7 c11">);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c15">return</span><span class="c10 c7 c11">&nbsp;EVENT_CONTINUE;</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c10 c7 c11"></span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c15">private</span><span class="c10 c11">&nbsp;</span><span class="c10 c15">bool</span><span class="c10 c11">&nbsp;TiltSettledEventHandler(</span><span class="c10 c15">string</span><span class="c10 c11">&nbsp;eventName, </span><span class="c10 c15">object</span><span class="c10 c7 c11">&nbsp;eventData)</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isTiltSettled = </span><span class="c10 c15">true</span><span class="c10 c7 c11">;</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RemoveModeEventHandler(</span><span class="c10 c26">&quot;Evt_TiltSettled&quot;</span><span class="c10 c7 c11">, TiltSettledEventHandler, Priority);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c15">if</span><span class="c10 c7 c11">&nbsp;(isBallDrained)</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EndOfBall();</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c15">return</span><span class="c10 c7 c11">&nbsp;EVENT_CONTINUE;</span></p><p class="c8"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p></td></tr></table><p class="c35"><span class="c6">In TiltedEventHandler, we launch the ball if a tilt is detected and the ball had not been launched yet. This gives good feedback the ball has been forfeited. The drain will also trigger the end of ball normally.</span></p><p class="c35"><span class="c6">Notice how TiltSettledEventHandler is registered dynamically when the ball has tilted. We don&rsquo;t want to register that handler in the constructor because Evt_TiltSettled is also sent after a tilt warning and that would confuse the end of ball processing.</span></p><h2 class="c20"><span class="c31 c7">Tilt Processing</span></h2><p class="c18"><span class="c6">After a tilt is detected, TiltedMode will block any target switch events and BallPath events. For some game modes, this is all the tilt processing that we need: these modes will no longer receive input and will lay dormant until the ball ends.</span></p><p class="c18"><span class="c6">More generally, a game mode needs to know if the ball has tilted to abstain from reinstating features disabled by TiltedMode. Any input not blocked by TiltedMode is suspicious, for example: delayed handlers, custom mode events, or internet messages.</span></p><p class="c18"><span class="c6">We want the modes to stop drawing on the screen. Most events destined to GUI should no longer be sent. If the mode has automatic GUI updates running on its behalf, it will have to instruct the SceneController to stop the updates. On the other hand, GUIInsert updates don&rsquo;t really matter because they will be overridden by TiltedMode&rsquo;s higher priority. </span></p><p class="c18"><span class="c6">Some modes hold the ball captive while they show some information on the screen. WAMONH&rsquo;s Supply Closet is a good example. These modes must implement tilt processing to launch the ball if tilt is detected when the ball is held. This gives good feedback to the player that the ball has tilted. It is also easier to implement since the ball drain will trigger the end of ball processing as usual. We did something in HomeMode if you remember.</span></p><p class="c18"><span class="c6">A multiball mode is often a special case of a mode that holds the ball. The multiball mode should go ahead and launch the ball if the ball is held with no other balls in play. The remaining pending launches should be discarded to speed up the end of the ball.</span></p><p class="c18"><span class="c6">You can open the profile menu by holding a flipper button and pressing start when the ball is pending launch. If you tilt the ball when the profile menu is still displayed, the profile menu continues to respond to the flipper buttons. This may or may not be a bug because the profile menu stays open and remains functional while the next ball is pending launch.</span></p><p class="c18"><span class="c6">Finally, there is no need to implement tilt processing when tilt detection is disabled:</span></p><ul class="c22 lst-kix_list_1-0"><li class="c1 c25 li-bullet-0"><span class="c6">in attract mode (LightShows)</span></li><li class="c1 c25 li-bullet-0"><span class="c6">when the bonus is displayed</span></li><li class="c1 c25 li-bullet-0"><span class="c6">at the end of the game when entering initials for high scores</span></li><li class="c1 c25 li-bullet-0"><span class="c6">in the settings menu</span></li><li class="c18 c21 li-bullet-0"><span class="c6">in the statistics menu</span></li></ul><h2 class="c20"><span class="c31 c7">Evt_TiltProcess</span></h2><p class="c18"><span class="c6">A game mode implements tilt processing by listening for the Evt_TiltProcess event. This event is sent at the end of TiltedEventHandler in HomeMode. Using a different event than Evt_Tilted guarantees HomeMode has time to initialize TiltedMode. </span></p><p class="c18"><span class="c6">One strategy for the Evt_TiltProcess event handler is to set a flag that can be tested later.</span></p><p class="c18"><span class="c6">The same code will be shared by many game modes, so it makes sense to move it to a common base class like P3SAGameMode. (Note P3SABaseGameMode is not applicable because it is the base mode of the game, not the base class of game modes). The code is not obtrusive so it can indeed be shared by all game modes.</span></p><p class="c18"><span class="c6">Edit Assets\Scripts\Modes\GameModes\P3SAGameMode.cs</span></p><a id="t.31ed23ca66d18259e7ca14e562c770efe50bac87"></a><a id="t.12"></a><table class="c28"><tr class="c12"><td class="c13" colspan="1" rowspan="1"><p class="c30"><span class="c10 c7 c11">...</span></p><p class="c0"><span class="c10 c17">protected bool isTilted;</span></p><p class="c0"><span class="c10 c7 c11">...</span></p><p class="c0"><span class="c16 c15">&nbsp; &nbsp; public</span><span class="c2">&nbsp;P3SAGameMode (P3Controller controller, </span><span class="c16 c15">int</span><span class="c2 c7">&nbsp;priority)</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; : </span><span class="c16 c15">base</span><span class="c2 c7">(controller, priority)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">AddModeEventHandler(</span><span class="c9">&quot;Evt_TiltProcess&quot;</span><span class="c10 c17 c11">, TiltProcessEventHandler, </span><span class="c10 c14">base</span><span class="c10 c17 c11">.Priority);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c10 c7 c11"></span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; public override void mode_started()</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; {</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">isTilted = false;</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; }</span></p><p class="c0"><span class="c10 c7 c11">...</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; </span><span class="c10 c17">protected virtual bool TiltProcessEventHandler(string eventName, object eventData)</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; </span><span class="c10 c17">{</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">isTilted = true;</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">return EVENT_CONTINUE;</span></p><p class="c8"><span class="c10">&nbsp; &nbsp; </span><span class="c10 c17">}</span></p></td></tr></table><p class="c35"><span class="c6">A specific game mode needs to check the isTested flag before executing problematic code:</span></p><a id="t.3a08bcade413b359b5bf917b5aca603ac9d5cfba"></a><a id="t.13"></a><table class="c28"><tr class="c12"><td class="c13" colspan="1" rowspan="1"><p class="c30"><span class="c10 c7 c11">...</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">if (!isTilted) {</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // problematic code here</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">}</span></p><p class="c8"><span class="c2 c7">...</span></p></td></tr></table><p class="c35"><span class="c6">A mode that holds the ball must override TiltProcessEventHandler to launch the dead ball:</span></p><a id="t.88e5782ee0625d02561b754fa9928ade1e412205"></a><a id="t.14"></a><table class="c28"><tr class="c12"><td class="c13" colspan="1" rowspan="1"><p class="c30"><span class="c2 c7">...</span></p><p class="c0"><span class="c10 c17">private bool isBallHeld = false;</span></p><p class="c0"><span class="c2 c7">...</span></p><p class="c0"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">isBallHeld = true;</span></p><p class="c0"><span class="c2 c7">...</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; </span><span class="c10 c17">protected override bool TiltProcessEventHandler(string eventName, object eventData)</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; </span><span class="c10 c17">{</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">if (isBallHeld) {</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">P3SABallLauncher.launch();</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">isBallHeld = false;</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">}</span></p><p class="c0"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17">return base.TiltProcessEventHandler(eventName, eventData);</span></p><p class="c8"><span class="c10">&nbsp; &nbsp; </span><span class="c10 c17">}</span></p></td></tr></table><p class="c35"><span class="c6">For many modes, it is easier to override TiltProcessEventHandler to immediately remove the mode. Clearly, the mode will not run problematic code anymore if it is stopped. This strategy does not work for all modes, so don&rsquo;t do this in P3SAGameMode. For example, removing HomeMode too early breaks the game.</span></p><p class="c35"><span class="c6">For the modes that can be removed immediately, you can add this event handler within the class:</span></p><a id="t.330c2ec7376b542a32bcf0db45bb4b1498227396"></a><a id="t.15"></a><table class="c28"><tr class="c12"><td class="c13" colspan="1" rowspan="1"><p class="c30"><span class="c2">&nbsp; &nbsp; </span><span class="c10 c14">protected</span><span class="c10 c17 c11">&nbsp;</span><span class="c10 c14">override</span><span class="c19 c14">&nbsp;</span><span class="c10 c14">bool</span><span class="c10 c17 c11">&nbsp;TiltProcessEventHandler(</span><span class="c10 c14">string</span><span class="c10 c17 c11">&nbsp;eventName, </span><span class="c10 c14">object</span><span class="c10 c17 c11">&nbsp;eventData)</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; </span><span class="c10 c17 c11">{</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">p3.RemoveMode(</span><span class="c10 c14">this</span><span class="c10 c17 c11">);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">return</span><span class="c10 c17 c11">&nbsp;EVENT_CONTINUE;</span></p><p class="c8"><span class="c10 c11">&nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p></td></tr></table><h2 class="c5"><span class="c31 c7">Game Modes</span></h2><p class="c18"><span class="c6">This section shows how to implement tilt processing in each game mode.</span></p><p class="c18"><span class="c6">Start by deleting the source files of these unused modes. There is no point in fixing unused code.</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\HomeIntroMode.cs</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\HomeIntroMode.cs.meta</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\LiteLockMode.cs</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\LiteLockMode.cs.meta</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\Multiball.cs</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\Multiball.cs.meta</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\TargetCompletionMode.cs</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\TargetCompletionMode.cs.meta</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\TargetSaveMode.cs</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\TargetSaveMode.cs.meta</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\TargetScoresMode.cs</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\TargetScoresMode.cs.meta</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\TimerMode.cs</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\TimerMode.cs.meta</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\TripleTargetsMode.cs</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\GameModes\TripleTargetsMode.cs.meta</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\LightShows\RotatingSmoothFadeMode.cs</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\LightShows\RotatingSmoothFadeMode.cs.meta</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\LightShows\SirenMode.cs</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\LightShows\SirenMode.cs.meta</span></p><p class="c24"><span class="c6">del Assets\Scripts\Modes\Mechs\CheatDetectorMode.cs</span></p><p class="c18 c41"><span class="c6">del Assets\Scripts\Modes\Mechs\CheatDetectorMode.cs.meta</span></p><p class="c18"><span class="c6">Edit these game modes to add the following TiltProcessEventHandler method:</span></p><p class="c32"><span class="c6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assets\Scripts\Modes\GameModes\LanesMode.cs</span></p><p class="c24"><span class="c6">Assets\Scripts\Modes\GameModes\RespawnMode.cs</span></p><p class="c24"><span class="c6">Assets\Scripts\Modes\GameModes\ShotCounter.cs</span></p><p class="c37"><span class="c6">Assets\Scripts\Modes\GameModes\SideTargetMode.cs</span></p><a id="t.330c2ec7376b542a32bcf0db45bb4b1498227396"></a><a id="t.16"></a><table class="c38"><tr class="c12"><td class="c44" colspan="1" rowspan="1"><p class="c30"><span class="c2">&nbsp; &nbsp; </span><span class="c10 c14">protected</span><span class="c10 c17 c11">&nbsp;</span><span class="c10 c14">override</span><span class="c14 c19">&nbsp;</span><span class="c10 c14">bool</span><span class="c10 c17 c11">&nbsp;TiltProcessEventHandler(</span><span class="c10 c14">string</span><span class="c10 c17 c11">&nbsp;eventName, </span><span class="c10 c14">object</span><span class="c10 c17 c11">&nbsp;eventData)</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; </span><span class="c10 c17 c11">{</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">p3.RemoveMode(</span><span class="c10 c14">this</span><span class="c10 c17 c11">);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">return</span><span class="c10 c17 c11">&nbsp;EVENT_CONTINUE;</span></p><p class="c8"><span class="c10 c11">&nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p></td></tr></table><p class="c35"><span class="c6">Edit these modes to handle the Evt_TiltProcess event. The code is different because these modes are not &nbsp;P3SAGameMode subclasses:</span></p><p class="c24"><span class="c6">Assets\Scripts\Modes\GameModes\TwitchControlMode.cs</span></p><p class="c24"><span class="c6">Assets\Scripts\Modes\GameModes\MovingTargetMode.cs</span></p><p class="c24"><span class="c6">Assets\Scripts\Modes\Mechs\ShotsMode.cs</span></p><p class="c24 c4"><span class="c6"></span></p><p class="c37"><span class="c6">Register the Evt_TiltProcess event handler in the constructor:</span></p><a id="t.51456395dde511448000316ffb141a7dd8d05789"></a><a id="t.17"></a><table class="c38"><tr class="c12"><td class="c44" colspan="1" rowspan="1"><p class="c46"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">AddModeEventHandler(</span><span class="c9">&quot;Evt_TiltProcess&quot;</span><span class="c10 c17 c11">, TiltProcessEventHandler, </span><span class="c10 c14">base</span><span class="c10 c17 c11">.Priority);</span></p></td></tr></table><p class="c41 c49"><span class="c6">Add the non-virtual TiltProcessEventHandler method:</span></p><a id="t.21e05c2114d188853e5043b1050ee0839ee68223"></a><a id="t.18"></a><table class="c38"><tr class="c12"><td class="c44" colspan="1" rowspan="1"><p class="c30"><span class="c2">&nbsp; &nbsp; </span><span class="c10 c14">private</span><span class="c16 c14">&nbsp;</span><span class="c10 c14">bool</span><span class="c10 c17 c11">&nbsp;TiltProcessEventHandler(</span><span class="c10 c14">string</span><span class="c10 c17 c11">&nbsp;eventName, </span><span class="c10 c14">object</span><span class="c10 c17 c11">&nbsp;eventData)</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; </span><span class="c10 c17 c11">{</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">p3.RemoveMode(</span><span class="c10 c14">this</span><span class="c10 c17 c11">);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">return</span><span class="c10 c17 c11">&nbsp;EVENT_CONTINUE;</span></p><p class="c8"><span class="c10 c11">&nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p></td></tr></table><p class="c53"><span class="c6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;See the next section for the GUI side of MovingTargetMode.</span></p><p class="c18"><span class="c6">Edit Assets\Scripts\Modes\SceneModes\IntroVideoMode.cs to add this TiltProcessEventHandler method. The Abort() call tells the GUI to stop playing the video when tilting:</span></p><a id="t.89876d445640d3c06521c79a730479e3c99a0ab9"></a><a id="t.19"></a><table class="c38"><tr class="c12"><td class="c57" colspan="1" rowspan="1"><p class="c30"><span class="c10 c11">&nbsp; &nbsp; </span><span class="c10 c14">protected</span><span class="c10 c17 c11">&nbsp;</span><span class="c10 c14">override</span><span class="c10 c17 c11">&nbsp;</span><span class="c10 c14">bool</span><span class="c10 c17 c11">&nbsp;TiltProcessEventHandler(</span><span class="c10 c14">string</span><span class="c10 c17 c11">&nbsp;eventName, </span><span class="c10 c14">object</span><span class="c10 c17 c11">&nbsp;eventData)</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; </span><span class="c10 c17 c11">{</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">Abort();</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; p3.RemoveMode(</span><span class="c10 c15">this</span><span class="c10 c7 c11">);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">return</span><span class="c10 c17 c11">&nbsp;EVENT_CONTINUE;</span></p><p class="c8"><span class="c10 c11">&nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p></td></tr></table><p class="c18 c4"><span class="c6"></span></p><p class="c18"><span class="c6">I have decided not to change HUDMode. The idea is to stop other modes from sending those events that need to be forwarded to the GUI.</span></p><p class="c18"><span class="c6">I have also decided to leave P3SAButtonCombos the way it is because it is mostly for system debugging. For a production game, I would rather remove this source file from the build.</span></p><p class="c18"><span class="c6">There is no need to implement tilt processing in these classes because they are not modes:</span></p><p class="c24"><span class="c6">Assets\Scripts\Modes\GameModes\ModeSummary.cs</span></p><p class="c18 c41"><span class="c6">Assets\Scripts\Modes\Mechs\P3SABallLauncher.cs</span></p><h2 class="c20"><span class="c31 c7">MovingTarget</span></h2><p class="c18"><span class="c6">When tilt is detected, MovingTargetMode removes itself but the cube continues to rotate and change color. To stop the cube immediately, you need to change the MovingTarget component.</span></p><p class="c18"><span class="c6">Edit Assets\Scripts\GUI\Home\MovingTarget.cs like this:</span></p><a id="t.f5a74872007c4539ab0c1424c7b2635eb284bd1c"></a><a id="t.20"></a><table class="c28"><tr class="c12"><td class="c13" colspan="1" rowspan="1"><p class="c30"><span class="c2 c7">...</span></p><p class="c0"><span class="c16 c15">&nbsp; &nbsp; public</span><span class="c2">&nbsp;</span><span class="c16 c15">class</span><span class="c2">&nbsp;</span><span class="c16 c36">MovingTarget</span><span class="c2 c7">&nbsp;: P3Aware {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">private bool isTilted;</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c16 c15">&nbsp; &nbsp; &nbsp; &nbsp; public</span><span class="c2">&nbsp;</span><span class="c16 c15">override</span><span class="c2">&nbsp;</span><span class="c16 c15">void</span><span class="c2">&nbsp;</span><span class="c16 c15">Start</span><span class="c2 c7">&nbsp;() {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">isTilted = </span><span class="c10 c14">false</span><span class="c10 c17 c11">;</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c16 c15">&nbsp; &nbsp; &nbsp; &nbsp; protected</span><span class="c2">&nbsp;</span><span class="c16 c15">override</span><span class="c2">&nbsp;</span><span class="c16 c15">void</span><span class="c2 c7">&nbsp;CreateEventHandlers() {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">AddModeEventHandler(</span><span class="c9">&quot;Evt_Tilted&quot;</span><span class="c10 c17 c11">, TiltedEventHandler);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">private</span><span class="c10 c17 c11">&nbsp;</span><span class="c10 c14">void</span><span class="c10 c17 c11">&nbsp;TiltedEventHandler(</span><span class="c10 c14">string</span><span class="c10 c17 c11">&nbsp;eventName, </span><span class="c10 c14">object</span><span class="c10 c17 c11">&nbsp;eventData) {</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">isTilted = </span><span class="c10 c14">true</span><span class="c10 c17 c11">;</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c16 c15">&nbsp; &nbsp; &nbsp; &nbsp; public</span><span class="c2">&nbsp;</span><span class="c16 c15">void</span><span class="c2">&nbsp;</span><span class="c16 c15">OnTriggerEnter</span><span class="c2 c7">(Collider other) {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">if</span><span class="c2">&nbsp;(</span><span class="c10 c17 c11">!isTilted &amp;&amp;</span><span class="c10 c11">&nbsp;</span><span class="c2">disabledCountdown &lt; 0) &nbsp;</span><span class="c16 c7 c27">// if we&#39;re not disabled</span></p><p class="c0"><span class="c16 c7 c27">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c16 c15">&nbsp; &nbsp; &nbsp; &nbsp; public</span><span class="c2">&nbsp;</span><span class="c16 c15">override</span><span class="c2">&nbsp;</span><span class="c16 c15">void</span><span class="c2">&nbsp;</span><span class="c16 c15">Update</span><span class="c2 c7">&nbsp;() {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">if</span><span class="c10 c17 c11">&nbsp;(!isTilted)</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">{</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ... original Update method body here ...</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p><p class="c8"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p></td></tr></table><h2 class="c5"><span class="c31 c7">TiltOverlay Prefab</span></h2><p class="c18"><span class="c6">We will create a prefab to show a tilt message on the screen. The next section will show how the prefab is used.</span></p><p class="c18"><span class="c6">The prefab is</span></p><ul class="c22 lst-kix_list_1-0"><li class="c1 c25 li-bullet-0"><span class="c6">a Canvas covering the whole playfield screen</span></li><li class="c1 c25 li-bullet-0"><span class="c6">a semi-translucent red background</span></li><li class="c18 c21 li-bullet-0"><span class="c6">and a Text message.</span></li></ul><p class="c18"><span class="c6">In the Unity Editor, select the Home scene.</span></p><p class="c18"><span class="c6">In the Hierarchy Window,</span></p><ul class="c22 lst-kix_list_1-0"><li class="c1 c25 li-bullet-0"><span class="c6">Click below the last item to make sure no item is selected.</span></li></ul><p class="c1 c4"><span class="c6"></span></p><ul class="c22 lst-kix_list_1-0"><li class="c1 c25 li-bullet-0"><span class="c6">Right-click, select UI &gt; Canvas. Rename the object TiltOverlay.</span></li></ul><p class="c1"><span class="c6">&nbsp; &nbsp;Within the &ldquo;Canvas Scaler&rdquo;, change the &ldquo;UI Scale Mode&rdquo; to &ldquo;Scale With Screen Size&rdquo;</span></p><p class="c1"><span class="c6">&nbsp; &nbsp;Change &ldquo;Reference Resolution&rdquo; X to 1080 and Y to 1920.</span></p><p class="c1 c4"><span class="c6"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 536.07px; height: 674.09px;"><img alt="" src="images/tilt/TiltOverlay.png" style="width: 536.07px; height: 674.09px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c4"><span class="c6"></span></p><p class="c1 c4"><span class="c6"></span></p><ul class="c22 lst-kix_list_1-0"><li class="c1 c25 li-bullet-0"><span class="c6">Right-click TiltOverlay, select UI &gt; Image. Rename the object TiltBackground.</span></li></ul><p class="c1"><span class="c6">&nbsp; &nbsp;Change Anchor Min X to 0, Anchor Min Y to 0.</span></p><p class="c1"><span class="c6">&nbsp; &nbsp;Change Anchor Max X to 1, Anchor Max Y to 1.</span></p><p class="c1"><span class="c6">&nbsp; &nbsp;Change Left to 0, Top to 0, Z to 0, Right to 0, Bottom to 0.</span></p><p class="c1"><span class="c6">&nbsp; &nbsp;Change the color to 255,0,0,96</span></p><p class="c1 c4"><span class="c6"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 499.07px; height: 492.07px;"><img alt="" src="images/tilt/TiltBackground.png" style="width: 499.07px; height: 492.07px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c4"><span class="c6"></span></p><p class="c1 c4"><span class="c6"></span></p><ul class="c22 lst-kix_list_1-0"><li class="c1 c25 li-bullet-0"><span class="c6">Right-click TiltOverlay, select UI &gt; Text. Rename the object to TiltText.</span></li></ul><p class="c1"><span class="c6">&nbsp; &nbsp;Make sure Pos X is 0, Pos Y is 0, Pos Z is 0.</span></p><p class="c1"><span class="c6">&nbsp; &nbsp;Change Width to 1080, Height to 1920</span></p><p class="c1"><span class="c6">&nbsp; &nbsp;Change Text to Warning.</span></p><p class="c1"><span class="c6">&nbsp; &nbsp;Change Font Style to Bold.</span></p><p class="c1"><span class="c6">&nbsp; &nbsp;Change Font Size to 200.</span></p><p class="c1"><span class="c6">&nbsp; &nbsp;Change the alignment to Horizontal Center and Vertical Center.</span></p><p class="c1"><span class="c6">&nbsp; &nbsp;Change the color to opaque white (255, 255, 255, 255)</span></p><p class="c18 c29"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 531.07px; height: 699.10px;"><img alt="" src="images/tilt/TiltText.png" style="width: 531.07px; height: 699.10px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18 c4"><span class="c6"></span></p><p class="c18"><span class="c6">In the Project window, expand Assets &gt; Resources and select Prefabs.</span></p><p class="c18"><span class="c6">Drag TiltOverlay from the Hierarchy window to the Assets &gt; Resources &gt; Prefabs Window.</span></p><p class="c18"><span class="c6">This will remove TiltOverlay from the Home scene and create a prefab called TiltOverlay.</span></p><h2 class="c5"><span class="c31 c7">HomeSceneController</span></h2><p class="c18"><span class="c6">Let us add feedback on the playfield&rsquo;s screen when a tilt warning or full tilt is detected. In your application, you should also add feedback on the backbox screen.</span></p><p class="c18"><span class="c6">Edit Assets\Scripts\GUI\Home\HomeSceneController.cs like this:</span></p><a id="t.a7e168c1ba625fc1aa767be7c1a0e758ceafa29a"></a><a id="t.21"></a><table class="c28"><tr class="c12"><td class="c13" colspan="1" rowspan="1"><p class="c0"><span class="c2 c7">...</span></p><p class="c0"><span class="c16 c15">&nbsp; &nbsp; &nbsp; &nbsp; private</span><span class="c2">&nbsp;</span><span class="c16 c15">float</span><span class="c2 c7">&nbsp;VUKStageTimer;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">private</span><span class="c10 c17 c11">&nbsp;</span><span class="c10 c14">float</span><span class="c10 c17 c11">&nbsp;tiltOverlayTimer;</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">private</span><span class="c2 c7">&nbsp;ModeSummaryDisplay modeSummaryDisplay;</span></p><p class="c8"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">private</span><span class="c10 c17 c11">&nbsp;GameObject tiltOverlay;</span></p><p class="c8"><span class="c2 c7">...</span></p><p class="c0"><span class="c16 c15">&nbsp; &nbsp; &nbsp; &nbsp; protected</span><span class="c2">&nbsp;</span><span class="c16 c15">override</span><span class="c2">&nbsp;</span><span class="c16 c15">void</span><span class="c2 c7">&nbsp;CreateEventHandlers() {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">AddModeEventHandler(</span><span class="c9">&quot;Evt_TiltWarning&quot;</span><span class="c10 c17 c11">, TiltWarningEventHandler);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">AddModeEventHandler(</span><span class="c9">&quot;Evt_Tilted&quot;</span><span class="c10 c17 c11">, TiltedEventHandler);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">AddModeEventHandler(</span><span class="c9">&quot;Evt_TiltComplete&quot;</span><span class="c10 c17 c11">, TiltCompleteEventHandler);</span></p><p class="c8"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">private</span><span class="c10 c17 c11">&nbsp;</span><span class="c10 c14">void</span><span class="c10 c17 c11">&nbsp;TiltWarningEventHandler(</span><span class="c10 c14">string</span><span class="c10 c17 c11">&nbsp;eventName, </span><span class="c10 c14">object</span><span class="c10 c17 c11">&nbsp;eventData)</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">{</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">ShowTiltOverlay(</span><span class="c9">&quot;Warning&quot;</span><span class="c10 c17 c11">, 2f);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p><p class="c0 c4"><span class="c10 c7 c11"></span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">private</span><span class="c10 c17 c11">&nbsp;</span><span class="c10 c14">void</span><span class="c10 c17 c11">&nbsp;TiltedEventHandler(</span><span class="c10 c14">string</span><span class="c10 c17 c11">&nbsp;eventName, </span><span class="c10 c14">object</span><span class="c10 c17 c11">&nbsp;eventData)</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">{</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">ShowTiltOverlay(</span><span class="c9">&quot;Tilt&quot;</span><span class="c10 c17 c11">, 0f);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p><p class="c0 c4"><span class="c10 c7 c11"></span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">private</span><span class="c10 c17 c11">&nbsp;</span><span class="c10 c14">void</span><span class="c10 c17 c11">&nbsp;TiltCompleteEventHandler(</span><span class="c10 c14">string</span><span class="c10 c17 c11">&nbsp;eventName, </span><span class="c10 c14">object</span><span class="c10 c17 c11">&nbsp;eventData)</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">{</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">if</span><span class="c10 c17 c11">&nbsp;(tiltOverlay != </span><span class="c10 c14">null</span><span class="c10 c17 c11">) {</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">Destroy(tiltOverlay);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">tiltOverlayTimer = 0f;</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p><p class="c0 c4"><span class="c10 c7 c11"></span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">private</span><span class="c10 c17 c11">&nbsp;</span><span class="c10 c14">void</span><span class="c10 c17 c11">&nbsp;ShowTiltOverlay(</span><span class="c10 c14">string</span><span class="c10 c17 c11">&nbsp;tiltMessage, </span><span class="c10 c14">float</span><span class="c10 c17 c11">&nbsp;timer)</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c11 c17">{</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">if</span><span class="c10 c17 c11">&nbsp;(tiltOverlay == </span><span class="c10 c14">null</span><span class="c10 c17 c11">) {</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">tiltOverlay = (GameObject)Instantiate(Resources.Load(</span><span class="c9">&quot;Prefabs/TiltOverlay&quot;</span><span class="c10 c17 c11">));</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">Transform tiltTextTransform = tiltOverlay.transform.Find(</span><span class="c9">&quot;TiltText&quot;</span><span class="c10 c17 c11">);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">if</span><span class="c10 c17 c11">&nbsp;(tiltTextTransform != </span><span class="c10 c14">null</span><span class="c10 c17 c11">) {</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">Text tiltText = tiltTextTransform.GetComponent&lt;Text&gt;();</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">if</span><span class="c10 c17 c11">&nbsp;(tiltText != </span><span class="c10 c14">null</span><span class="c10 c17 c11">) {</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">tiltText.text = tiltMessage;</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">tiltOverlayTimer = timer;</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c27">// Update is called once per frame</span></p><p class="c8"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">public</span><span class="c2">&nbsp;</span><span class="c16 c15">override</span><span class="c2">&nbsp;</span><span class="c16 c15">void</span><span class="c2">&nbsp;</span><span class="c16 c15">Update</span><span class="c2 c7">&nbsp;() {</span></p><p class="c8"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">if</span><span class="c10 c17 c11">&nbsp;(tiltOverlayTimer &gt; 0) {</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">tiltOverlayTimer -= Time.deltaTime;</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">if</span><span class="c10 c17 c11">&nbsp;(tiltOverlayTimer &lt;= 0)</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">{</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">Destroy(tiltOverlay);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p><p class="c8"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c8"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p></td></tr></table><p class="c18 c4"><span class="c6"></span></p><h2 class="c20"><span class="c31 c7">TiltEnable Default</span></h2><p class="c18"><span class="c6">The default value of the settings &ldquo;Tilt Detection Enable&rdquo; is false. If you want your application to be sensitive to the tilt bob by default, you will need to override the default for the TiltEnable GameAttribute.</span></p><p class="c18"><span class="c6">The default value of the settings &ldquo;Tilt Bob Enable&rdquo; is true. There is no need to override that default.</span></p><p class="c32"><span class="c6">Edit Assets\Scripts\Modes\DataManagement\P3SASettingsMode.cs to modify the CustomizeGameAttribute() method after the comment:</span></p><p class="c32 c4"><span class="c6"></span></p><a id="t.823416707d7910519db5101b4ef02241e059dce6"></a><a id="t.22"></a><table class="c28"><tr class="c12"><td class="c47" colspan="1" rowspan="1"><p class="c30"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protected override GameAttribute CustomizeGameAttribute(GameAttribute attr)</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span></p><p class="c0"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Set the following values based on what&#39;s appropriate for your game</span></p><p class="c0"><span class="c16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c10 c17">else if (attr.item == &quot;TiltEnable&quot;)</span></p><p class="c0"><span class="c10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c10 c17">{</span></p><p class="c0"><span class="c10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c10 c17">attr.value.Set(true);</span></p><p class="c0"><span class="c10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c10 c17">attr.defaultValue.Set(true);</span></p><p class="c0"><span class="c10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c10 c17">attr.compareOptions = GameAttributeCompareOptions.CompareAllExceptValue | GameAttributeCompareOptions.UpdateValueIfDefaultChanged;</span></p><p class="c0"><span class="c10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c10 c17">}</span></p><p class="c8"><span class="c2 c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span></p></td></tr></table><p class="c18 c4"><span class="c6"></span></p><h2 class="c20"><span class="c31 c7">showBonusIfTiltActive</span></h2><p class="c18"><span class="c6">By default, tilting sets the bonus to 0 and the bonus sequence is not shown on the screen.</span></p><p class="c18"><span class="c6">If you play WAMONH, you will notice the bonus is shown even if the ball has tilted. This section shows how to implement this feature. This is optional.</span></p><p class="c18"><span class="c6">Edit Assets\Scripts\Modes\P3SABaseGameMode.cs to set the flag showBonusIfTiltActive in the constructor. This tells BaseGameMode to show the bonus even if the ball has tilted.</span></p><a id="t.e7ac42098fe04cb7ce5a4d3d5a1b1168be13211c"></a><a id="t.23"></a><table class="c28"><tr class="c12"><td class="c13" colspan="1" rowspan="1"><p class="c30"><span class="c2 c7">...</span></p><p class="c0"><span class="c16 c15">&nbsp; &nbsp; &nbsp; &nbsp; public</span><span class="c2 c7">&nbsp;P3SABaseGameMode (P3Controller controller)</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : </span><span class="c16 c15">base</span><span class="c2 c7">(controller)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; enableTwitchIntegration = </span><span class="c16 c15">true</span><span class="c2 c7">;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">showBonusIfTiltActive = </span><span class="c10 c14">true</span><span class="c10 c17 c11">;</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c8"><span class="c2">...</span></p></td></tr></table><p class="c18 c4"><span class="c6"></span></p><p class="c18"><span class="c6">Edit Assets\Scripts\Modes\SceneModes\HomeMode.cs to</span></p><ul class="c22 lst-kix_list_1-0"><li class="c1 c25 li-bullet-0"><span class="c6">change the title of the Bonus window to &ldquo;NO BONUS&rdquo; when tilted.</span></li><li class="c1 c25 li-bullet-0"><span class="c6">add a negative bonus item when tilted.</span></li><li class="c18 c21 li-bullet-0"><span class="c6">change the title of the Bonus window back to normal when tilt processing is complete</span></li></ul><a id="t.bf944a2fa794c8fc140754df37a29d839c373846"></a><a id="t.24"></a><table class="c28"><tr class="c12"><td class="c45" colspan="1" rowspan="1"><p class="c30"><span class="c2 c7">...</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">public</span><span class="c2">&nbsp;HomeMode (P3Controller controller, </span><span class="c16 c15">int</span><span class="c2">&nbsp;priority, </span><span class="c16 c15">string</span><span class="c2 c7">&nbsp;SceneName)</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : </span><span class="c16 c15">base</span><span class="c2 c7">(controller, priority, SceneName)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AddModeEventHandler(</span><span class="c3">&quot;Evt_BallSearchBallLaunchRequest&quot;</span><span class="c2 c7">, BallSearchBallLaunchRequestEventHandler, Priority);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AddModeEventHandler(</span><span class="c3">&quot;Evt_TiltWarning&quot;</span><span class="c2 c7">, TiltWarningEventHandler, Priority);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AddModeEventHandler(</span><span class="c3">&quot;Evt_Tilted&quot;</span><span class="c2 c7">, TiltedEventHandler, Priority);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">AddModeEventHandler(&quot;Evt_TiltProcessingComplete&quot;, TiltProcessingCompleteEventHandler, Priority);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0"><span class="c2 c7">...</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">public</span><span class="c2">&nbsp;</span><span class="c16 c15">virtual</span><span class="c2 c7">&nbsp;BonusInfo getBonusInfo()</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BonusInfo info = </span><span class="c16 c15">new</span><span class="c2 c7">&nbsp;BonusInfo();</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info.Append (getBonusItems());</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">if</span><span class="c10 c17 c11">&nbsp;(isTiltActive)</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">{</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">info.AddItem(</span><span class="c10 c14">new</span><span class="c10 c17 c11">&nbsp;BonusItem(</span><span class="c9">&quot;TILT&quot;</span><span class="c10 c17 c11">, (</span><span class="c10 c14">long</span><span class="c10 c17 c11">)(-info.GetTotal() * ScoreManager.GetBonusX())));</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">info.SetMultiplier(0f);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">else</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">{</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">info.SetMultiplier(ScoreManager.GetBonusX());</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c15 c16">return</span><span class="c2 c7">&nbsp;info;</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2 c7">...</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">private</span><span class="c2">&nbsp;</span><span class="c16 c15">bool</span><span class="c2">&nbsp;TiltedEventHandler(</span><span class="c16 c15">string</span><span class="c2">&nbsp;eventName, </span><span class="c16 c15">object</span><span class="c2 c7">&nbsp;eventData)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isTiltActive = </span><span class="c16 c15">true</span><span class="c2 c7">;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isTiltSettled = </span><span class="c16 c15">false</span><span class="c2 c7">;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AddModeEventHandler(</span><span class="c3">&quot;Evt_TiltSettled&quot;</span><span class="c2 c7">, TiltSettledEventHandler, Priority);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PostModeEventToGUI(</span><span class="c3">&quot;Evt_Tilted&quot;</span><span class="c2">, </span><span class="c16 c15">null</span><span class="c2 c7">);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c27">// PlaySound(&quot;TiltSound&quot;);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c7 c27">// PlaySound(&quot;TiltVoiceMessage&quot;);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">PostModeEventToGUI(&quot;Evt_DefineBonusTitle&quot;, &quot;NO BONUS&quot;);</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">base</span><span class="c2 c7">.p3.AddMode(tiltedMode);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">if</span><span class="c2 c7">&nbsp;(!ballStarted)</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PostModeEventToGUI(</span><span class="c3">&quot;Evt_HideButtonLegend&quot;</span><span class="c2 c7">, 0);</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ballStartMode.Disable();</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; P3SABallLauncher.launch();</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PostModeEventToModes(</span><span class="c3">&quot;Evt_TiltProcess&quot;</span><span class="c2">, </span><span class="c16 c15">null</span><span class="c2 c7">);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c16 c15">return</span><span class="c2 c7">&nbsp;EVENT_CONTINUE;</span></p><p class="c0"><span class="c2 c7">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2 c7">...</span></p><p class="c0 c4"><span class="c2 c7"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">private</span><span class="c10 c17 c11">&nbsp;</span><span class="c10 c14">bool</span><span class="c10 c17 c11">&nbsp;TiltProcessingCompleteEventHandler(</span><span class="c10 c14">string</span><span class="c10 c17 c11">&nbsp;eventName, </span><span class="c10 c14">object</span><span class="c10 c17 c11">&nbsp;eventData)</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">{</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">if</span><span class="c10 c17 c11">&nbsp;(isTiltActive)</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">{</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">PostModeEventToGUI(</span><span class="c9">&quot;Evt_DefineBonusTitle&quot;</span><span class="c10 c17 c11">, </span><span class="c9">&quot;BONUS&quot;</span><span class="c10 c17 c11">);</span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p><p class="c0"><span class="c10 c7 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c0"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c14">return</span><span class="c10 c17 c11">&nbsp;EVENT_CONTINUE;</span></p><p class="c8"><span class="c10 c11">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c17 c11">}</span></p></td></tr></table><p class="c35"><span class="c6">Evt_TiltProcessingComplete is sent when TiltMode is removed which happens when resetting to a new ball but before HomeMode is removed. Clearly the bonus is no longer displayed at that time.</span></p><h2 class="c20"><span class="c31 c7">Testing</span></h2><p class="c18"><span class="c6">To help testing tilt in the simulator, edit Configuration\AppConfig.json and add this key mapping:</span></p><a id="t.3b5cac9236f40c63c40860bac49f5f77fc3eb66a"></a><a id="t.25"></a><table class="c28"><tr class="c12"><td class="c13" colspan="1" rowspan="1"><p class="c46"><span class="c48">&nbsp; &nbsp; </span><span class="c42 c17">{&quot;Key&quot;:&quot;T&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;Switch&quot;:&quot;tilt&quot;},</span></p></td></tr></table><p class="c35"><span class="c6">Now when running the application within the simulator, pressing the letter T will activate the tilt switch.</span></p><p class="c35"><span class="c6">To unblock the application when a full tilt is detected, press 0 (zero). This simulates a ball drain and triggers the end of ball processing.</span></p><p class="c35"><span class="c6">Make sure to enable both &ldquo;Tilt Detection Enabled&rdquo; and &ldquo;Use tilt bob for tilt detection&rdquo; under Settings/Mechs/Tilt within the service menu.</span></p><p class="c35"><span class="c6">Don&rsquo;t forget to also set both settings when deploying the application. The settings on the machine are independent of the settings in the simulator.</span></p></body></html>
