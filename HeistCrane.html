<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=fpjTOVmNbO4Lz34iLyptLROjXfSpIU_1TsQlCJ7q4WlXEixY9aqhie8CVYCrTb1E);.lst-kix_list_2-6>li:before{content:"\0025cf   "}.lst-kix_list_2-7>li:before{content:"o  "}ul.lst-kix_list_1-0{list-style-type:none}.lst-kix_list_2-4>li:before{content:"o  "}.lst-kix_list_2-5>li:before{content:"\0025aa   "}.lst-kix_list_2-8>li:before{content:"\0025aa   "}.lst-kix_list_3-0>li:before{content:"-  "}ul.lst-kix_list_5-7{list-style-type:none}ul.lst-kix_list_5-8{list-style-type:none}.lst-kix_list_3-1>li:before{content:"o  "}.lst-kix_list_3-2>li:before{content:"\0025aa   "}ul.lst-kix_list_5-5{list-style-type:none}ul.lst-kix_list_3-7{list-style-type:none}ul.lst-kix_list_5-6{list-style-type:none}ul.lst-kix_list_3-8{list-style-type:none}ul.lst-kix_list_1-3{list-style-type:none}ul.lst-kix_list_3-1{list-style-type:none}.lst-kix_list_3-5>li:before{content:"\0025aa   "}ul.lst-kix_list_5-0{list-style-type:none}ul.lst-kix_list_1-4{list-style-type:none}ul.lst-kix_list_3-2{list-style-type:none}ul.lst-kix_list_1-1{list-style-type:none}.lst-kix_list_3-4>li:before{content:"o  "}ul.lst-kix_list_1-2{list-style-type:none}ul.lst-kix_list_3-0{list-style-type:none}ul.lst-kix_list_5-3{list-style-type:none}ul.lst-kix_list_1-7{list-style-type:none}.lst-kix_list_3-3>li:before{content:"\0025cf   "}ul.lst-kix_list_3-5{list-style-type:none}ul.lst-kix_list_5-4{list-style-type:none}ul.lst-kix_list_1-8{list-style-type:none}ul.lst-kix_list_3-6{list-style-type:none}ul.lst-kix_list_5-1{list-style-type:none}ul.lst-kix_list_1-5{list-style-type:none}ul.lst-kix_list_3-3{list-style-type:none}ul.lst-kix_list_5-2{list-style-type:none}ul.lst-kix_list_1-6{list-style-type:none}ul.lst-kix_list_3-4{list-style-type:none}.lst-kix_list_3-8>li:before{content:"\0025aa   "}.lst-kix_list_4-0>li:before{content:"\0025cf   "}.lst-kix_list_4-1>li:before{content:"o  "}.lst-kix_list_3-6>li:before{content:"\0025cf   "}.lst-kix_list_3-7>li:before{content:"o  "}.lst-kix_list_4-4>li:before{content:"o  "}.lst-kix_list_4-3>li:before{content:"\0025cf   "}.lst-kix_list_4-5>li:before{content:"\0025aa   "}.lst-kix_list_4-2>li:before{content:"\0025aa   "}.lst-kix_list_4-6>li:before{content:"\0025cf   "}.lst-kix_list_5-0>li:before{content:"-  "}.lst-kix_list_4-8>li:before{content:"\0025aa   "}.lst-kix_list_5-3>li:before{content:"\0025cf   "}.lst-kix_list_4-7>li:before{content:"o  "}.lst-kix_list_5-2>li:before{content:"\0025aa   "}.lst-kix_list_5-1>li:before{content:"o  "}ul.lst-kix_list_4-8{list-style-type:none}.lst-kix_list_5-7>li:before{content:"o  "}ul.lst-kix_list_4-6{list-style-type:none}.lst-kix_list_5-6>li:before{content:"\0025cf   "}.lst-kix_list_5-8>li:before{content:"\0025aa   "}ul.lst-kix_list_2-8{list-style-type:none}ul.lst-kix_list_4-7{list-style-type:none}ul.lst-kix_list_4-0{list-style-type:none}ul.lst-kix_list_2-2{list-style-type:none}ul.lst-kix_list_4-1{list-style-type:none}.lst-kix_list_1-0>li:before{content:"\002b9a   "}ul.lst-kix_list_2-3{list-style-type:none}.lst-kix_list_5-4>li:before{content:"o  "}ul.lst-kix_list_2-0{list-style-type:none}ul.lst-kix_list_2-1{list-style-type:none}ul.lst-kix_list_4-4{list-style-type:none}.lst-kix_list_5-5>li:before{content:"\0025aa   "}ul.lst-kix_list_2-6{list-style-type:none}ul.lst-kix_list_4-5{list-style-type:none}.lst-kix_list_1-1>li:before{content:"o  "}.lst-kix_list_1-2>li:before{content:"\0025aa   "}ul.lst-kix_list_2-7{list-style-type:none}ul.lst-kix_list_4-2{list-style-type:none}ul.lst-kix_list_2-4{list-style-type:none}ul.lst-kix_list_4-3{list-style-type:none}ul.lst-kix_list_2-5{list-style-type:none}.lst-kix_list_1-3>li:before{content:"\0025cf   "}.lst-kix_list_1-4>li:before{content:"o  "}.lst-kix_list_1-7>li:before{content:"o  "}.lst-kix_list_1-5>li:before{content:"\0025aa   "}.lst-kix_list_1-6>li:before{content:"\0025cf   "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_list_2-0>li:before{content:"-  "}.lst-kix_list_2-1>li:before{content:"o  "}.lst-kix_list_1-8>li:before{content:"\0025aa   "}.lst-kix_list_2-2>li:before{content:"\0025aa   "}.lst-kix_list_2-3>li:before{content:"\0025cf   "}ol{margin:0;padding:0}table td,table th{padding:0}.c24{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;background-color:#e7e6e6;border-left-style:solid;border-bottom-width:1pt;width:243.2pt;border-top-color:#000000;border-bottom-style:solid}.c11{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:42.8pt;border-top-color:#000000;border-bottom-style:solid}.c26{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:190.7pt;border-top-color:#000000;border-bottom-style:solid}.c15{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:106pt;border-top-color:#000000;border-bottom-style:solid}.c31{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:318.9pt;border-top-color:#000000;border-bottom-style:solid}.c8{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:16.3pt;border-top-color:#000000;border-bottom-style:solid}.c23{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:205pt;border-top-color:#000000;border-bottom-style:solid}.c16{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:58.4pt;border-top-color:#000000;border-bottom-style:solid}.c6{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:13.8pt;border-top-color:#000000;border-bottom-style:solid}.c20{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:56.2pt;border-top-color:#000000;border-bottom-style:solid}.c21{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:163.1pt;border-top-color:#000000;border-bottom-style:solid}.c49{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:182.8pt;border-top-color:#000000;border-bottom-style:solid}.c2{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:33.4pt;border-top-color:#000000;border-bottom-style:solid}.c43{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:240.9pt;border-top-color:#000000;border-bottom-style:solid}.c40{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:243.2pt;border-top-color:#000000;border-bottom-style:solid}.c39{padding-top:2pt;padding-bottom:0pt;line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left;margin-right:55.5pt}.c34{padding-top:12pt;padding-bottom:0pt;line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left;margin-right:55.5pt}.c32{color:#2f5496;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:13pt;font-family:"Calibri";font-style:normal}.c45{padding-top:12pt;padding-bottom:0pt;line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c44{padding-top:2pt;padding-bottom:0pt;line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c41{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9.5pt;font-family:"Consolas";font-style:normal}.c37{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Calibri";font-style:italic}.c50{padding-top:12pt;padding-bottom:8pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left;margin-right:55.5pt}.c13{color:#333333;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Verdana";font-style:normal}.c47{padding-top:6pt;padding-bottom:8pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left;margin-right:55.5pt}.c22{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:8.5pt;font-family:"Consolas";font-style:normal}.c35{color:#2f5496;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Calibri";font-style:normal}.c30{padding-top:0pt;padding-bottom:8pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left;margin-right:55.5pt}.c7{padding-top:0pt;padding-bottom:8pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left;margin-right:48.5pt}.c4{padding-top:0pt;padding-bottom:0pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left;margin-right:13.1pt}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Consolas";font-style:normal}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Calibri";font-style:normal}.c5{padding-top:0pt;padding-bottom:0pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c33{padding-top:0pt;padding-bottom:8pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c61{padding-top:12pt;padding-bottom:8pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c3{padding-top:0pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c63{padding-top:0pt;padding-bottom:6pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c64{font-size:9.5pt;font-family:"Consolas";color:#0000ff;font-weight:400}.c58{font-size:9pt;font-family:"Verdana";color:#333333;font-weight:400}.c53{font-size:9.5pt;font-family:"Consolas";color:#000000;font-weight:400}.c66{font-size:9.5pt;font-family:"Consolas";color:#a31515;font-weight:400}.c51{border-spacing:0;border-collapse:collapse;margin-right:auto}.c60{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#0000ff;text-decoration:underline}.c68{background-color:#ffffff;max-width:530.5pt;padding:72pt 9.6pt 72pt 72pt}.c62{page-break-after:avoid;margin-right:55.5pt;height:13pt}.c59{font-size:9pt;font-family:"Consolas";font-weight:400}.c9{margin-left:36pt;margin-right:48.5pt}.c54{color:inherit;text-decoration:inherit}.c56{padding:0;margin:0}.c14{margin-left:-5.1pt;margin-right:-34.4pt}.c10{margin-left:36pt}.c12{margin-right:-48pt}.c27{margin-right:48.5pt}.c25{height:11pt}.c52{margin-right:13.1pt}.c36{margin-right:-183.2pt}.c46{margin-right:-245.4pt}.c29{margin-right:-112pt}.c67{margin-right:55.5pt}.c18{height:0pt}.c28{margin-right:-132.8pt}.c42{margin-right:20.1pt}.c48{margin-right:-1.1pt}.c38{background-color:#e7e6e6}.c55{margin-right:-429.1pt}.c57{margin-right:8.9pt}.c19{text-indent:36pt}.c17{padding-left:0pt}.c65{margin-right:41.4pt}.title{padding-top:24pt;color:#000000;font-weight:700;font-size:36pt;padding-bottom:6pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:18pt;color:#666666;font-size:24pt;padding-bottom:4pt;font-family:"Georgia";line-height:1.0791666666666666;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Calibri"}p{margin:0;color:#000000;font-size:11pt;font-family:"Calibri"}h1{padding-top:12pt;color:#2f5496;font-size:16pt;padding-bottom:0pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:2pt;color:#2f5496;font-size:13pt;padding-bottom:0pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:14pt;color:#000000;font-weight:700;font-size:14pt;padding-bottom:4pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:12pt;color:#000000;font-weight:700;font-size:12pt;padding-bottom:2pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:11pt;color:#000000;font-weight:700;font-size:11pt;padding-bottom:2pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:10pt;color:#000000;font-weight:700;font-size:10pt;padding-bottom:2pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}</style></head><body class="c68 doc-content"><h1 class="c34"><span class="c35">Heist Crane</span></h1><p class="c30"><span class="c0">The Heist crane is one of the best mech in all of pinball.</span></p><p class="c30"><span>The </span><span class="c60"><a class="c54" href="https://www.multimorphic.com/support/projects/customer-support/wiki/Heist">Heist section of the support wiki</a></span><span class="c0">&nbsp;has a lot of information detailing how to troubleshoot and repair the crane.</span></p><p class="c30"><span class="c0">On the programming side, the documentation is the file ~/.multimorphic/P3/ModuleDrivers/Heist/1.2.0.0/HeistModuleCapabilities.cs</span></p><p class="c30"><span class="c0">This tech tip describes the crane and how to control it in software.</span></p><p class="c30"><span>Note: the discovery of undocumented events was made possible by the comprehensive event log technique described in the </span><span class="c60"><a class="c54" href="events.html">Events tech tip</a></span><span class="c0">.</span></p><h2 class="c39"><span class="c32">Crane Functions</span></h2><p class="c30"><span class="c0">The crane can move left-to-right, up and down and extend forward. There is a magnet in the head that can pick up the ball. In the center of the magnet, there is a pin to sense the ball. There is a front target that can be bashed. There is also an RGB LED in the front.</span></p><p class="c30"><span class="c0">The right wireform has a lever that can lock the ball. An opto near the lever can detect when a ball is locked.</span></p><h2 class="c39"><span class="c32">Crane Components</span></h2><p class="c30"><span class="c0">The module definition file ~/.multimorphic/P3/ModuleDrivers/Heist/1.2.0.0/Heist.json describes the components of the playfield, including the crane.</span></p><p class="c30"><span class="c0">The crane can sweep left-to-right with the servo named craneRotation located underneath the playfield. </span></p><p class="c30"><span class="c0">The crane can pitch up and down with the servo named cranePitch located to the right of the mast. This servo is connected to a round piece called the horn which lifts or lowers a lever underneath the crane. Higher values move the crane up but if you go too high, the rotation overshoots and the crane starts to move down. </span></p><p class="c30"><span class="c0">The crane can extend or retract with the stepper motor named crane (labeled Crane Extension in diagnostics). The stepper is located in the top left of the crane. It drives a belt that moves a carriage that pushes or pulls the crane extension.</span></p><p class="c30"><span class="c0">The coil stepperEnable must be enabled for the crane stepper to work. The module driver takes care of that.</span></p><p class="c30"><span class="c0">When not in motion, you can safely manually pull or push the crane extension. Never try to sweep or pitch the crane manually since that could force the servos.</span></p><p class="c30"><span class="c0">The magnet is a coil named craneMagnet. The coil is magnetized when it is energized.</span></p><p class="c30"><span class="c0">The crane has a micro switch in the back of the extension to detect when it is fully retracted. The switch is named CraneHome but it is labeled &ldquo;Crane Retracted&rdquo; in diagnostics.</span></p><p class="c30"><span class="c0">The front target has a switch named Crane to detect when it is bashed. This switch is named &ldquo;Crane Target&rdquo; in diagnostics. The switch is implemented by an opto underneath a small board in the crane head. When the front target is hit, it rotates, rising just high enough to block a light beam underneath the board.</span></p><p class="c30"><span class="c0">The switch that detects when the magnet touches the ball is named CraneMagnet. This switch is implemented by another opto underneath the board in the crane head. When the ball hits the free moving pin passing through the middle of the magnet, this lifts the pin, blocking the opto light beam.</span></p><p class="c30"><span class="c0">The crane has another switch named CraneStop. This switch is named &ldquo;Crane Contact&rdquo; in diagnostics. This switch detects when the crane frame touches something metallic like the wireform. This switch is currently not used by the Heist module driver nor any application running on the Heist module. You can ignore it.</span></p><p class="c30"><span class="c0">The LED in the crane head is named crane.</span></p><p class="c30"><span class="c0">The ball lock lever on the wireform is controlled by the servo named ballLock. This is a two-position servo. It can be either up or down.</span></p><p class="c30"><span class="c0">The switch that detects if there is a ball locked on the wireform is named WireLock0 but it appears as &ldquo;Wireform Lock&rdquo; in diagnostics. This switch is implemented with an opto in front of the lock lever.</span></p><p class="c30"><span class="c0">There is an extra switch named WireLock1 listed in HeistModuleSwitches in HeistModuleCapabilities. Maybe there was a second wire lock switch in an early prototype but it does not exist in the production version. You will not find it in diagnostics either.</span></p><h2 class="c39"><span class="c32">Crane LED</span></h2><p class="c33"><span class="c0">The crane LED is like any other LED on the module. You can control it with a LEDScript.</span></p><p class="c33"><span class="c0">For example, this will make the crane LED blink in red:</span></p><p class="c3 c10"><span class="c41">private LEDScript craneScript;</span></p><p class="c3 c10 c25"><span class="c41"></span></p><p class="c3 c10"><span class="c53">craneScript = </span><span class="c64">new</span><span class="c53">&nbsp;LEDScript(p3.LEDs[</span><span class="c66">&quot;crane&quot;</span><span class="c41">], this.Priority);</span></p><p class="c3 c10"><span class="c41">craneScript.AddCommand(Multimorphic.P3.Colors.Color.red, 0, 1);</span></p><p class="c3 c10"><span class="c41">craneScript.AddCommand(Multimorphic.P3.Colors.Color.black, 0, 0.5);</span></p><p class="c3 c10"><span class="c41">p3.LEDController.AddScript(craneScript, -1);</span></p><p class="c3 c10 c25"><span class="c41"></span></p><p class="c33"><span class="c0">Don&rsquo;t forget to remove the script when done or when the mode is stopped:</span></p><p class="c33"><span class="c59">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p3.LEDController.RemoveScript(</span><span class="c53">craneScript</span><span class="c1">);</span></p><p class="c7"><span class="c0">The LED simulator does not emulate the crane LED, so you won&#39;t find it on Display #8. While tracking the crane movement is complex, displaying the crane LED in a static location would have been straightforward.</span></p><h2 class="c44"><span class="c32">Crane Bashing</span></h2><p class="c33 c65"><span class="c0">When the crane is low enough, the front can be bashed with the ball. The application can detect a bash hit with a handler for the front switch:</span></p><h2 class="c39 c10"><span class="c1">public bool sw_Crane_active(Switch sw) {</span></h2><p class="c5 c10"><span class="c1">&nbsp; &nbsp; &hellip;</span></p><p class="c5 c10"><span class="c1">&nbsp; &nbsp;return SWITCH_CONTINUE;</span></p><p class="c33 c10"><span class="c1">}</span></p><p class="c7"><span class="c0">The Heist module driver is unusual because it forwards many switch events as mode to mode events. It is therefore possible to implement the bash detection with a regular event handler:</span></p><p class="c5 c9"><span class="c1">// when the handler is needed</span></p><p class="c5 c10"><span class="c1">AddModeEventHandler(&quot;sw_Crane_active&quot;, CraneBashHitEventHandler, this.Priority);</span></p><p class="c5 c10 c25"><span class="c1"></span></p><p class="c5 c10"><span class="c1">// when the handler is no longer needed</span></p><p class="c5 c10"><span class="c1">RemoveModeEventHandler(&quot;sw_Crane_active&quot;, CraneBashHitEventHandler, this.Priority);</span></p><h2 class="c5 c10 c62"><span class="c1"></span></h2><p class="c5 c10 c25"><span class="c1"></span></p><p class="c5 c10"><span class="c1">private bool CraneBashHitEventHandler(string eventName, object eventData) {</span></p><p class="c5 c10"><span class="c1">&nbsp; &nbsp; &hellip;</span></p><p class="c5 c10"><span class="c1">&nbsp; &nbsp; return EVENT_CONTINUE;</span></p><p class="c33 c10"><span class="c1">}</span></p><p class="c30"><span class="c0">Some people may find the event code easier to read if you need to dynamically register and remove the handler. The call to dynamically register switch handlers is less known.</span></p><h2 class="c34"><span class="c32">GameAttributes</span></h2><p class="c30"><span class="c0">The Heist module driver defines the following &ldquo;Playfield Module Local GameAttributes&rdquo;. They will appear in the service menu at Settings/Mech/Crane. The application automatically inherits those settings when running with the Heist module. To access this menu when the application is running, open the coin door and press the Launch button.</span></p><a id="t.9b894b14cee2a12ef75ee1dc402b9a10faa674d7"></a><a id="t.0"></a><table class="c51"><tr class="c18"><td class="c6 c38" colspan="1" rowspan="1"><p class="c3 c14 c25"><span class="c0"></span></p></td><td class="c15 c38" colspan="1" rowspan="1"><p class="c3 c46"><span class="c0">GameAttribute Name</span></p></td><td class="c23 c38" colspan="1" rowspan="1"><p class="c3 c28"><span class="c0">Description</span></p></td><td class="c11 c38" colspan="1" rowspan="1"><p class="c3 c29"><span class="c0">Default</span></p></td><td class="c11 c38" colspan="1" rowspan="1"><p class="c3 c36"><span class="c0">Min</span></p></td><td class="c2 c38" colspan="1" rowspan="1"><p class="c3 c12"><span class="c0">Max </span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c3 c14 c25"><span class="c0"></span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c3 c46"><span class="c0">EnableCrane</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c3 c28"><span class="c0">Crane must be enabled to function</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c29"><span class="c0">Yes</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c36"><span class="c0">No</span></p></td><td class="c2" colspan="1" rowspan="1"><p class="c3 c12"><span class="c0">Yes</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c3 c14"><span class="c0">&nbsp;*</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c3 c46"><span class="c0">CranePitchMax</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c3 c57"><span class="c0">Max height the crane will rise,</span></p><p class="c3 c57"><span class="c0">higher value is higher towards glass</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c29"><span class="c0">255</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c36"><span class="c0">60</span></p></td><td class="c2" colspan="1" rowspan="1"><p class="c3 c12"><span class="c0">255</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c3 c14"><span class="c0">&nbsp;*</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c3 c46"><span class="c0">CranePitchMin</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c3 c28"><span class="c0">Min height the crane will lower,</span></p><p class="c3 c28"><span class="c0">lower value is lower towards playfield</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c29"><span class="c0">180</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c36"><span class="c0">60</span></p></td><td class="c2" colspan="1" rowspan="1"><p class="c3 c12"><span class="c0">255</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c3 c14"><span class="c0">&nbsp;*</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c3 c46"><span class="c0">CranePitchPickup</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c3 c28"><span class="c0">Height the crane moves to for ball pickup</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c29"><span class="c0">200</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c36"><span class="c0">60</span></p></td><td class="c2" colspan="1" rowspan="1"><p class="c3 c12"><span class="c0">255</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c3 c14"><span class="c0">&nbsp;*</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c3 c46"><span class="c0">CraneSweepRightMax</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c3 c28"><span class="c0">Max distance the crane will move right,</span></p><p class="c3 c28"><span class="c0">lower value is further right towards the lock</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c29"><span class="c0">60</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c36"><span class="c0">50</span></p></td><td class="c2" colspan="1" rowspan="1"><p class="c3 c12"><span class="c0">255</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c3 c14"><span class="c0">&nbsp;*</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c3 c46" id="h.gjdgxs"><span class="c0">CraneSweepLeftMax</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c3 c28"><span class="c0">Max distance the crane will move left,</span></p><p class="c3 c28"><span class="c0">higher value is further away from the lock</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c29"><span class="c0">185</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c36"><span class="c0">60</span></p></td><td class="c2" colspan="1" rowspan="1"><p class="c3 c12"><span class="c0">255</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c3 c14"><span class="c0">&nbsp;*</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c3 c46"><span class="c0">CraneSweepHome</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c3 c28"><span class="c0">Distance the crane moves right for ball</span></p><p class="c3 c28"><span class="c0">pickup, lower value is further right,</span></p><p class="c3 c28"><span class="c0">should be the same as CraneSweepRightMax</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c29"><span class="c0">62</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c36"><span class="c0">50</span></p></td><td class="c2" colspan="1" rowspan="1"><p class="c3 c12"><span class="c0">255</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c3 c14"><span class="c0">&nbsp;*</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c3 c46"><span class="c0">StepperMaxSteps</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c3 c28"><span class="c13">Maximum the crane will extend,</span></p><p class="c3 c28"><span class="c58">higher value is further towards the flippers </span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c29"><span class="c0">1000</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c36"><span class="c0">200</span></p></td><td class="c2" colspan="1" rowspan="1"><p class="c3 c12"><span class="c0">6000</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c3 c14"><span class="c0">&nbsp;*</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c3 c46"><span class="c0">CraneExtensionHome</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c3 c28"><span class="c0">Distance the crane will extend to for ball</span></p><p class="c3 c28"><span class="c0">pickup, 0 is fully retracted, higher is more</span></p><p class="c3 c28"><span class="c0">extended</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c29"><span class="c0">0</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c36"><span class="c0">0</span></p></td><td class="c2" colspan="1" rowspan="1"><p class="c3 c12"><span class="c0">100</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c3 c14 c25"><span class="c0"></span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c3 c55"><span class="c0">CranePickupRetryMax</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c3 c28"><span class="c0">How many pickup attempts before giving up</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c29"><span class="c0">5</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c3 c36"><span class="c0">1</span></p></td><td class="c2" colspan="1" rowspan="1"><p class="c3 c12"><span class="c0">10</span></p></td></tr></table><p class="c50"><span class="c0">GameAttributes marked with * are automatically calculated during crane validation. The values should be fairly accurate and there is usually no need to change them. With that said, you may want to manually adjust the pickup location slightly after crane calibration for improved results (i.e. CranePitchPickup, CraneSweepRightMax, CraneSweepHome, CraneExtensionHome).</span></p><p class="c50"><span class="c0">CraneSweepRightMax is the maximum the crane can sweep right, so this is the minimum sweep value. They could have called it CraneSweepMin for symmetry with CranePitchMin but then it would not have been clear if the min is left or right of the playfield.</span></p><p class="c50"><span class="c0">The application can read those settings like this:</span></p><p class="c33 c52"><span class="c22">int cranePitchMax = data.GetGameAttributeValue(&quot;PlayfieldModuleLocalSettings&quot;, &quot;CranePitchMax&quot;).ToInt();</span></p><p class="c30"><span class="c0">This is not common in the application because the module driver can usually handle these crane details.</span></p><p class="c30"><span class="c0">The Heist application extends the Settings/Mech/Crane menu with one more GameAttribute:</span></p><a id="t.aaeea82d5348560c21ecd70f0938a2674075391a"></a><a id="t.1"></a><table class="c51"><tr class="c18"><td class="c21 c38" colspan="1" rowspan="1"><p class="c3 c46"><span class="c0">GameAttribute Display Name</span></p></td><td class="c31 c38" colspan="1" rowspan="1"><p class="c3 c28"><span class="c0">Description</span></p></td></tr><tr class="c18"><td class="c21" colspan="1" rowspan="1"><p class="c3 c46"><span class="c0">Calibrate Crane</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c3 c28"><span class="c0">Run the interactive crane calibration process now</span></p></td></tr></table><p class="c47"><span class="c0">There is no value for this GameAttribute because it triggers an action after confirmation. This is achieved with the GameAttribute options (GameAttributeOptions.Action | GameAttributeOptions.Confirm).</span></p><p class="c47"><span class="c0">The CraneCalibrationMode is part of the Heist application instead of the module driver, so no other application will inherit this menu action. Users must run the Heist application if they want to run crane calibration.</span></p><p class="c47"><span class="c0">An application might want to define other application-specific GameAttributes for things like the crane bash height, crane ball knock-off height, crane move speed. For example, the Heist application has this GameAttribute under Service Menu/Settings/Gameplay/Crane.</span></p><a id="t.d185baee61e7f2150abdbb52d9f1f0a693851582"></a><a id="t.2"></a><table class="c51"><tr class="c18"><td class="c21 c38" colspan="1" rowspan="1"><p class="c3 c46"><span class="c0">GameAttribute Display Name</span></p></td><td class="c31 c38" colspan="1" rowspan="1"><p class="c3 c28"><span class="c0">Description</span></p></td></tr><tr class="c18"><td class="c21" colspan="1" rowspan="1"><p class="c3 c46"><span class="c0">Crane Ball Flipper Knockoff Height</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c3 c28"><span class="c0">Height in ball diameters above the playfield for flipper knockoff</span></p></td></tr></table><h2 class="c45"><span class="c32">HeistModuleCapabilities</span></h2><p class="c30"><span class="c0">The documentation for the Heist module programming interface is in ~/.multimorphic/P3/ModuleDrivers/Heist/1.2.0.0/HeistModuleCapabilities.cs</span></p><p class="c30"><span class="c0">This file is in C# for historical reasons. Look for the information in comments.</span></p><p class="c30"><span class="c0">In the following sections, we describe the crane API and expand on that documentation.</span></p><p class="c30"><span class="c0">We do not cover the CraneHoverRequest class because some documentation is missing (like the name of the event). In any case, that feature is implemented in the Heist application, not in the module driver, therefore no other application can use it.</span></p><p class="c30"><span class="c0">BallPaths, two-position servos and locking a ball are not covered here because these topics are reserved for another P3 Tech Tip.</span></p><h2 class="c44"><span class="c32">Crane Coordinates</span></h2><p class="c7"><span class="c0">The crane API defines a coordinate system based on 3 independent axes: pitch, sweep and extend. This is not a cartesian or polar coordinate system.</span></p><p class="c7"><span class="c0">Pitch is a ushort from 0 to 255, but it is only valid from CranePitchMin to CranePitchMax (default from 180 to 255). The maximum height is typically achieved around 220. A request to pitch outside the valid region logs an error message and the command is ignored.</span></p><p class="c7"><span class="c0">Sweep is a ushort from 0 to 255, but it is only valid from CraneSweepRightMax to CraneSweepLeftMax (default from 60 to 185). Note 0 is the wireform position, not all the way right on the playfield. A request to sweep outside the valid region logs an error message and the command is ignored. </span></p><p class="c7"><span class="c0">Extend is a ushort from 0 to StepperMaxSteps (typically 1000). A request to extend to less than or equal to 0 &nbsp;fully retracts the crane. A request to extend to StepperMaxSteps or more extends to StepperMaxSteps exactly. There is no error message if the value is out of bounds.</span></p><p class="c7"><span class="c0">It is also possible to specify a float value as a percentage between 0 and 1. The value 0 means the lowest valid value. The value 1 means the highest valid value. Any other fraction is the percentage between the lowest and highest value. For example, the value 0.5 is the middle point between the low and high values.</span></p><p class="c7"><span class="c0">Surprisingly, sweep 0.5 is not the middle of the playfield. It is about 2 inches to the right of what you expect. This is not a bug. The value is indeed the middle of the range but there is no requirement that the range be centered.</span></p><p class="c7"><span class="c0">Using percentages is preferred over ushort units.</span></p><p class="c7"><span class="c0">The application can compute percentages programmatically like this if needed:</span></p><p class="c4"><span class="c22">int pitchMin = data.GetGameAttributeValue(&quot;PlayfieldModuleLocalSettings&quot;, &quot;CranePitchMin&quot;).ToInt();</span></p><p class="c4"><span class="c22">int pitchMax = data.GetGameAttributeValue(&quot;PlayfieldModuleLocalSettings&quot;, &quot;CranePitchMax&quot;).ToInt();</span></p><p class="c33 c52"><span class="c22">float pitchPercent = (float)(pitch &ndash; pitchMin) / (pitchMax &ndash; pitchMin);</span></p><p class="c4"><span class="c22">int sweepMin = data.GetGameAttributeValue(&quot;PlayfieldModuleLocalSettings&quot;, &quot;CraneSweepLeftMax&quot;).ToInt();</span></p><p class="c4"><span class="c22">int sweepMax = data.GetGameAttributeValue(&quot;PlayfieldModuleLocalSettings&quot;, &quot;CraneSweepLeftMax&quot;).ToInt();</span></p><p class="c33 c52"><span class="c22">float sweepPercent = (float)(sweep &ndash; sweepMin) / (sweepMax &ndash; sweepMin);</span></p><p class="c4"><span class="c22">// extendMin is always 0</span></p><p class="c4"><span class="c22">int extendMax = data.GetGameAttributeValue(&quot;PlayfieldModuleLocalSettings&quot;, &quot;StepperMaxSteps&quot;).ToInt();</span></p><p class="c33 c52"><span class="c22">float extendPercent = (float)extend / extendMax;</span></p><p class="c7"><span class="c0">In practice, the percentage is likely already known as part of the game design. In that case, there is no need to compute the percentage from the GameAttributes. This is doubly beneficial since the application does not have to implement handlers to detect when the GameAttribute values change in the Service Menu.</span></p><h2 class="c44 c27"><span class="c32">Crane Moves</span></h2><p class="c33"><span class="c0">These mode to modes events move the crane along one of the axes:</span></p><p class="c5 c19"><span class="c0">Evt_CranePitchMoveTo</span></p><p class="c5 c19"><span class="c0">Evt_CraneSweepMoveTo</span></p><p class="c33 c19"><span class="c0">Evt_CraneExtendTo</span></p><p class="c7"><span class="c0">The event argument can be specified in any of the following ways:</span></p><ul class="c56 lst-kix_list_3-0 start"><li class="c5 c9 c17 li-bullet-0"><span class="c0">A ushort in the range described above</span></li><li class="c5 c9 c17 li-bullet-0"><span class="c0">A float between 0 and 1 as the percentage between the low and high values</span></li><li class="c5 c9 c17 li-bullet-0"><span class="c0">A KeyValuePair&lt;ushort, double&gt; as the ushort coordinate and the move duration</span></li><li class="c7 c10 c17 li-bullet-0"><span class="c0">A KeyValuePair&lt;float, double&gt; as the float percentage and the move duration. This is the recommended way.</span></li></ul><p class="c7"><span class="c0">The duration in the KeyValuePair is how long the crane will take to reach its destination in seconds.</span></p><p class="c7"><span class="c0">Passing a ushort or a float argument uses the default duration as follows.</span></p><ul class="c56 lst-kix_list_5-0 start"><li class="c5 c9 c17 li-bullet-0"><span class="c0">The default pitch duration is calculated to be about 20 units per second. For example, a pitch of 40 units with default duration will take 2 seconds.</span></li><li class="c5 c9 c17 li-bullet-0"><span class="c0">The default sweep duration is calculated to be about 100 units per second. For example, a sweep of 50 units with default duration will take 0.5 seconds.</span></li><li class="c7 c10 c17 li-bullet-0"><span class="c0">The default extend duration is calculated to be about 755 units per second. For example, going from fully retracted to 1000 with default duration will take 1.32 seconds.</span></li></ul><p class="c7"><span class="c0">There is no software limit on how fast or how slow the pitch or sweep servos can move.</span></p><p class="c7"><span class="c0">The minimum stepper speed is about 465 units per second. If you try to move the stepper slower, the duration will be adjusted to 465 units per second with a warning. The maximum stepper speed is 755 units per second. If you try to move the extend stepper faster than 755 units per second, it will be slowed down to 755 units per second with a warning.</span></p><p class="c7"><span class="c0">These examples show the various argument types (they don&rsquo;t do anything particularly useful as a group):</span></p><p class="c5 c27"><span class="c0">ushort pitch = 200;</span></p><p class="c7"><span class="c0">ushort extend = 800;</span></p><p class="c5"><span class="c0">PostModeEventToModes(&quot;Evt_CranePitchMoveTo&quot;, pitch);</span></p><p class="c5"><span class="c0">PostModeEventToModes(&quot;Evt_CraneSweepMoveTo&quot;, 0.5f);</span></p><p class="c5"><span class="c0">PostModeEventToModes(&quot;Evt_CraneExtendTo&quot;, new KeyValuePair&lt;ushort, double&gt;(extend, 1.32));</span></p><p class="c5"><span class="c0">PostModeEventToModes(&quot;Evt_CraneSweepMoveTo&quot;, new KeyValuePair&lt;float, double&gt;(0.5f, 2.0));</span></p><p class="c5 c25"><span class="c0"></span></p><p class="c27 c63"><span class="c0">This example combines multiple movements to move the crane in bash position near the center of the playfield in 5 seconds.</span></p><p class="c5 c9"><span class="c1">double craneMoveDuration = 5d;</span></p><p class="c5 c9"><span class="c1">float cranePitch = 1.0f;</span></p><p class="c5 c9"><span class="c1">float craneSweep = 0.5f;</span></p><p class="c5 c9"><span class="c1">float craneExtension = 1.0f;</span></p><p class="c5 c9 c25"><span class="c1"></span></p><p class="c5 c9"><span class="c1">PostModeEventToModes(&quot;Evt_CraneSweepMoveTo&quot;,</span></p><p class="c5 c9 c19"><span class="c1">new KeyValuePair&lt;float, double&gt;(craneSweep, craneMoveDuration));</span></p><p class="c5 c9"><span class="c1">PostModeEventToModes(&quot;Evt_CranePitchMoveTo&quot;,</span></p><p class="c5 c9 c19"><span class="c1">new KeyValuePair&lt;float, double&gt;(cranePitch, craneMoveDuration));</span></p><p class="c5 c9"><span class="c1">PostModeEventToModes(&quot;Evt_CraneExtendTo&quot;,</span></p><p class="c5 c9 c19"><span class="c1">new KeyValuePair&lt;float, double&gt;(craneExtension, craneMoveDuration));</span></p><p class="c5 c25"><span class="c0"></span></p><p class="c5 c67"><span class="c0">This code assumes the crane starts over the playfield and has already cleared the wireform. If you run this code when the crane is in the home position, you run the risk of pitching into the wireform or extending into the lock lever. The order in which the movements are performed matter and you need to sometimes delay a movement before another one starts.</span></p><p class="c5 c25"><span class="c0"></span></p><h2 class="c44"><span class="c32">Crane Status Events</span></h2><p class="c33"><span class="c0">When a crane move is initiated, the module driver sends notification events.</span></p><p class="c33"><span class="c0">When executing Evt_CranePitchMoveTo, the module driver sends these status events in order:</span></p><p class="c5"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Evt_CraneMove_Pitch_Started</span></p><p class="c5"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; Evt_CurrentCranePitch (both mode to modes and mode to GUI at regular intervals)</span></p><p class="c5"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; Evt_TextDriverPitch (at regular intervals)</span></p><p class="c5 c19"><span class="c0">Evt_CraneMove_Pitch_Done</span></p><p class="c33 c19"><span class="c0">Evt_ServoParked_cranePitch</span></p><p class="c33"><span class="c0">When executing Evt_CraneSweepMoveTo, the module driver sends these status events in order:</span></p><p class="c5"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Evt_CraneMove_Sweep_Started</span></p><p class="c5"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; Evt_CurrentCraneSweep (both mode to modes and mode to GUI at regular intervals)</span></p><p class="c5"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; Evt_TextDriverSweep (at regular intervals)</span></p><p class="c5"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Evt_CraneMove_Sweep_Done</span></p><p class="c33"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Evt_ServoParked_craneRotation</span></p><p class="c33"><span class="c0">When executing Evt_CraneExtendTo, the module driver sends these status events in order:</span></p><p class="c5"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Evt_CraneMove_Extension_Started</span></p><p class="c5"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; Evt_CurrentCraneExtension (both mode to modes and mode to GUI at regular intervals)</span></p><p class="c33"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; Evt_TextDriverExtension (at regular intervals)</span></p><p class="c27 c61"><span class="c0">There is no equivalent of the Done or Parked events for the crane extension. The application must estimate an appropriate delay based on the corrected duration.</span></p><h2 class="c44 c27"><span class="c32">Crane Routines</span></h2><p class="c7"><span class="c0">The predefined crane routines combine multiple crane movements to perform a specific function. It is much easier to call these routines than to try to reimplement them yourself.</span></p><p class="c7"><span class="c0">There are 3 routines: send home, pickup and drop.</span></p><p class="c7"><span class="c0">The following sections describe one routine at a time.</span></p><h2 class="c44"><span class="c32">Send Home Routine</span></h2><p class="c7"><span class="c0">The Evt_CraneSendHome event moves the crane to the home position, ready for pickup. The event argument is not used.</span></p><p class="c7 c19"><span class="c1">PostModeEventToModes(&quot;Evt_CraneSendHome&quot;, null);</span></p><p class="c7"><span class="c0">This routine starts by retracting the crane. The routine will retry multiple times if the &ldquo;Crane Retracted&rdquo; switch is not activated.</span></p><p class="c7"><span class="c0">Once the crane is fully retracted, the routine lifts and sweeps the crane to the pickup location. There is no retry for these movements.</span></p><p class="c7"><span class="c0">It is also possible to send the crane home on each axis independently. This does not retry and requires some precaution to avoid hitting the crane against the wireform.</span></p><p class="c5 c19 c27"><span class="c1">PostModeEventToModes(&quot;Evt_CraneExtendTo&quot;, 0);</span></p><p class="c5 c27 c19"><span class="c1">...add a delay here to wait for the crane to retract...</span></p><p class="c5 c27 c19"><span class="c1">PostModeEventToModes(&quot;Evt_CranePitchSendHome&quot;, null);</span></p><p class="c7 c19"><span class="c1">PostModeEventToModes(&quot;Evt_CraneSweepMoveToPickup&quot;, null);</span></p><p class="c7"><span class="c0">The module driver sends these status events when it thinks the crane is in the home position on an axis:</span></p><p class="c5 c27 c19"><span class="c1">PostModeEventToModes(&quot;Evt_CraneStepperIsHome&quot;, null);</span></p><p class="c5 c27 c19"><span class="c1">PostModeEventToModes(&quot;Evt_CranePitchHome&quot;, pitchAsUshort);</span></p><p class="c7 c19"><span class="c1">PostModeEventToModes(&quot;Evt_CraneSweepHome&quot;, sweepAsUshort);</span></p><p class="c7"><span class="c0">For the pitch axis, this happens when the target position is either CranePitchMax or CranePitchPickup.</span></p><p class="c7"><span class="c0">For the sweep axis, this happens when the target position is CraneSweepHome.</span></p><p class="c7"><span class="c0">The routine sends these status events in order:</span></p><p class="c5 c9"><span class="c0">&hellip; see status events for Evt_CraneExtendTo in earlier section &hellip;</span></p><p class="c5 c9"><span class="c0">Evt_CraneStepperIsHome</span></p><p class="c5 c9"><span class="c0">Evt_CraneSendHomeWhenStepperDone</span></p><p class="c5 c9"><span class="c0">&hellip; see status events for Evt_CranePitchMoveTo and Evt_CraneSweepMoveTo in earlier section &hellip;</span></p><p class="c5 c9"><span class="c0">Evt_CraneSweepHome</span></p><p class="c7 c10"><span class="c0">Evt_CranePitchHome</span></p><p class="c7"><span class="c0">The application knows the routine has finished when it receives both Evt_CraneSweepHome and Evt_CranePitchHome.</span></p><h2 class="c44 c27"><span class="c32">Pickup Routine</span></h2><p class="c7"><span class="c0">The Evt_CranePickup event loads the ball onto the crane if a ball is available in lock position. The event argument is not used.</span></p><p class="c7 c19"><span class="c1">PostModeEventToModes(&quot;Evt_CranePickup&quot;, null);</span></p><p class="c7"><span class="c0">This routine combines moving the crane to the home position, dipping the crane, magnetizing, lifting then sweeping to the middle of playfield with the ball still held by the crane.</span></p><p class="c7"><span class="c0">If everything goes well, the routine sends the following status events. The routine logs a message each time it progresses to the next stage (these log messages are represented by C# comments in the trace below).</span></p><p class="c5 c9"><span class="c0">// Crane Load requested</span></p><p class="c5 c9"><span class="c0">// Start Homing For Pickup - awaiting CraneSweepHome</span></p><p class="c5 c9"><span class="c0">Evt_CraneSendHome</span></p><p class="c5 c9"><span class="c0">&hellip; see status events for Evt_CraneSendHome routine in earlier section &hellip;</span></p><p class="c5 c9"><span class="c0">// Crane Load State Proceeding: Homing; event trigger : Evt_CraneMove_Sweep_Done</span></p><p class="c5 c9"><span class="c0">// Crane Load State: Finishing Homing</span></p><p class="c5 c9"><span class="c0">// Crane Load State: Dipping</span></p><p class="c5 c9"><span class="c0">Evt_CranePitchMoveToPickup</span></p><p class="c5 c9"><span class="c0">Evt_CraneSweepMoveToPickup</span></p><p class="c5 c9"><span class="c0">&hellip; see status events for Evt_CranePitchMoveTo and Evt_CraneSweepMoveTo in earlier section &hellip;</span></p><p class="c5 c9"><span class="c0">// Crane Load State: Finishing Dipping</span></p><p class="c5 c9"><span class="c0">// Ball On Crane: False</span></p><p class="c5 c9"><span class="c0">Evt_BallLeftLock</span></p><p class="c5 c9"><span class="c0">Evt_BallOnMagnet</span></p><p class="c5 c9"><span class="c0">Evt_BallOnCrane</span></p><p class="c5 c9"><span class="c0">// Crane Load State Proceeding: Magnetizing; event trigger : Evt_BallOnCrane</span></p><p class="c5 c9"><span class="c0">// Crane Load State: Lifting</span></p><p class="c5 c9"><span class="c0">Evt_CraneSweepMoveToPickup</span></p><p class="c5 c9"><span class="c0">Evt_CraneExtendToAlmostPickup</span></p><p class="c5 c9"><span class="c0">Evt_CranePitchSendHome</span></p><p class="c5 c10 c48"><span class="c0">&hellip; see status events for Evt_CranePitchMoveTo, Evt_CraneSweepMoveTo, Evt_CraneExtendTo in earlier section</span></p><p class="c5 c9"><span class="c0">// Crane Load State Proceeding: Lifting; event trigger : Evt_CraneMove_Pitch_Done</span></p><p class="c5 c9"><span class="c0">// Crane Load State: Finish Lifting</span></p><p class="c5 c9"><span class="c0">Evt_CraneSweepMoveToPickup</span></p><p class="c5 c9"><span class="c0">// Crane Load State: Delivering</span></p><p class="c5 c9"><span class="c0">Evt_CraneSweepMoveTo</span></p><p class="c5 c9"><span class="c0">Evt_CraneDeliveringBallAfterPickup</span></p><p class="c5 c10 c42"><span class="c0">&hellip; see status events for Evt_CraneSweepMoveTo in earlier section &hellip;</span></p><p class="c5 c10 c42"><span class="c0">// Crane Load State Proceeding: Delivering; event trigger : Evt_CraneMove_Sweep_Done</span></p><p class="c5 c10 c42"><span class="c0">// Crane Load State: Finish Delivering</span></p><p class="c5 c10 c42"><span class="c0">// Sending CraneLoaded</span></p><p class="c33 c10 c42"><span class="c0">Evt_CraneLoaded</span></p><p class="c7"><span class="c0">When running in the simulator, the routine triggers the Evt_SimulationWaitingForBallOnCrane event when finishing dipping. In response, the CraneMagnetMode sends Evt_BallLeftLock, Evt_BallOnMagnet and Evt_BallOnCrane tricking the application into believing that the ball has raised above the wireform opto and is now held by the magnet.</span></p><p class="c7"><span class="c0">The application knows the routine completed successfully when it receives the Evt_CraneLoaded event. The event argument is always true.</span></p><p class="c7"><span class="c0">Conversely, the application must be ready to handle errors.</span></p><p class="c7"><span class="c0">If the crane is already attempting to pickup the ball, the routine logs an error and ignores the request. The earlier request continues to execute. The application will interpret the result of the earlier request as the result of this request.</span></p><p class="c7"><span class="c0">If the crane is already holding the ball, the routine logs an error and sends the event Evt_CraneLoadFailed. The event argument is the string &quot;AlreadyHadBall&quot;. This is probably a logic error in the application.</span></p><p class="c7"><span class="c0">If the crane fails to pickup the ball, it sends the error event Evt_CraneDeliveringNoBallAfterPickup and it continues with the delivery sweep without a ball. At the end of the delivery sweep, it sends the Evt_CraneLoadFailed event with string argument &quot;NoBall&quot;. One possibility is the ball never made it to the lock position to begin with. Another possibility is the ball is still sitting in the lock position but the crane could not lift it for some reason. The application should take mitigation action to continue the gameplay.</span></p><h2 class="c44 c27"><span class="c32">Drop Routine</span></h2><p class="c7"><span class="c0">The Evt_CraneDrop event drops the ball held by the crane. The argument data is not used.</span></p><p class="c7 c19"><span class="c1">PostModeEventToModes(&quot;Evt_CraneDrop&quot;, null);</span></p><p class="c7"><span class="c0">The routine ignores the request if there is a pickup in progress, otherwise it demagnetizes the crane.</span></p><p class="c7"><span class="c0">The routine sends these status events:</span></p><p class="c5 c9"><span class="c0">// Disabling crane magnet due to CraneDrop event</span></p><p class="c5 c9"><span class="c0">Evt_BallOffMagnet</span></p><p class="c5 c9"><span class="c0">Evt_BallOffCrane (both mode to modes and mode to GUI)</span></p><p class="c7 c10"><span class="c0">// CraneMechMode sees BallOffCrane during None</span></p><p class="c7"><span class="c0">When running in the simulator, the routine sends the Evt_SimulationWaitingForBallOffCrane event. In response, the CraneMagnetMode emulates the deactivation of the CraneMagnet switch, tricking the application into believing that the ball has indeed dropped from the crane.</span></p><h2 class="c44"><span class="c32">Ball Knock Off</span></h2><p class="c30"><span class="c0">The ball in play can knock off the ball suspended on the magnet provided the crane is loaded and low enough. Be careful when pitching down not to crash the suspended ball into the screen. The exact height might also depend whether it matters if the infrared grid detects the suspended ball or not.</span></p><p class="c30"><span class="c0">After the crane is loaded, the application can detect the ball is knocked off the magnet by implementing an event handler for Evt_BallOffCrane.</span></p><p class="c5 c9"><span class="c1">// when the handler is needed</span></p><p class="c5 c10"><span class="c1">AddModeEventHandler(&quot;Evt_BallOffCrane&quot;, BallOffCraneEventHandler, this.Priority);</span></p><p class="c5 c10 c25"><span class="c1"></span></p><p class="c5 c10"><span class="c1">// when the handler is no longer needed</span></p><p class="c5 c10"><span class="c1">RemoveModeEventHandler(&quot;Evt_BallOffCrane&quot;, BallOffCraneEventHandler, this.Priority);</span></p><p class="c5 c10 c25"><span class="c1"></span></p><p class="c5 c10"><span class="c1">private bool BallOffCraneEventHandler(string eventName, object eventData) {</span></p><p class="c5 c10"><span class="c1">&nbsp; &nbsp; &hellip;</span></p><p class="c5 c10"><span class="c1">&nbsp; &nbsp; return EVENT_CONTINUE;</span></p><p class="c5 c10"><span class="c1">}</span></p><h2 class="c45"><span class="c32">Best Practices</span></h2><p class="c7"><span class="c0">The module driver documentation highlights some best practices necessary to guarantee smooth operation of the crane. These practices are so important that we copy them below.</span></p><ul class="c56 lst-kix_list_3-0"><li class="c5 c9 c17 li-bullet-0"><span class="c37">Sweep the crane out from the home position prior to issuing additional move commands, this avoids collisions with the wireform and lock arm.</span></li><li class="c5 c9 c17 li-bullet-0"><span class="c37">Lower the lock arm servo prior to moving the crane in or out (issue a right ramp lock or servo up/down command</span></li><li class="c5 c9 c17 li-bullet-0"><span class="c37">Retract the crane stepper at the beginning of a move, extend at the end</span></li><li class="c5 c9 c17 li-bullet-0"><span class="c37">Use the right data types in your crane position request events (see above)</span></li><li class="c5 c9 c17 li-bullet-0"><span class="c37">Don&rsquo;t raise the crane to 0% (all the way up) while extended - it will likely contact the playfield glass (if glass is installed)</span></li><li class="c5 c9 c17 li-bullet-0"><span class="c37">Don&rsquo;t retract the crane into the wall/scoop assembly while raised</span></li><li class="c7 c10 c17 li-bullet-0"><span class="c37">Don&rsquo;t Extend the crane while in the pickup position</span></li></ul><h2 class="c44"><span class="c32">Appendix: Event Reference</span></h2><p class="c33"><span class="c0">The following table lists the Mode to Modes events related to the crane.</span></p><p class="c5"><span class="c0">A * indicates an undocumented event in HeistModuleCapabilities.cs</span></p><p class="c5 c25"><span class="c0"></span></p><a id="t.500c923388d7ec8eb0d34da4e9e2c646ada7f8b9"></a><a id="t.3"></a><table class="c51"><tr class="c18"><td class="c8 c38" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c26 c38" colspan="1" rowspan="1"><p class="c3"><span class="c0">Mode to Modes Event</span></p></td><td class="c20 c38" colspan="1" rowspan="1"><p class="c3"><span class="c0">Argument</span></p></td><td class="c24" colspan="1" rowspan="1"><p class="c3"><span class="c0">Description</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_BallLeftLock</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">int</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">The ball has left the lock area on the right wireform. Argument is number of remaining locked balls.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_BallOffCrane</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">true</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">The magnet switch deactivated. Sent to modes and GUI.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_BallOffMagnet</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">true</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">The magnet switch deactivated. Same as Evt_BallOffCrane but sent to modes only.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_BallOnCrane</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">true</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">The magnet switch activated. Sent to modes and GUI.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_BallOnMagnet</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">true</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">The magnet switch activated. Same as Evt_BallOnCrane, but sent to modes only.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneDeliveringBallAfterPickup</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">null</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">During the pickup routine, the crane successfully picked up the ball and is initiating the delivery sweep.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneDeliveringNoBallAfterPickup</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">null</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">During the pickup routine, the crane failed to pick up the ball and is initiating the delivery sweep with no ball.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneDrop</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">null</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Request to initiate the drop routine.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneExtendTo</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">4 options</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Request the crane extension to move to the target value. Argument is the target extension and an optional duration.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneExtendToAlmostPickup</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">double</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Move the crane to 0.9 of the home position.</span></p><p class="c3"><span class="c0">The argument is the move duration.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneLoadFailed</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">string</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">The pickup routine completed unsuccessfully and the crane is over the playfield without a ball.</span></p><p class="c3"><span class="c0">The argument is a reason like &quot;NoBall&quot; or &quot;AlreadyHadBall&quot;.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneLoaded</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">true</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">The pickup routine completed successfully and the crane is holding the ball over the playfield.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneMove_Extension_Started</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">ushort</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent when an extension is initiated.</span></p><p class="c3"><span class="c0">The argument is the target extension value.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneMove_Pitch_Done</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">ushort</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent when a pitch move is complete.</span></p><p class="c3"><span class="c0">Argument is the current pitch value.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneMove_Pitch_Started</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">ushort</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent when a pitch is initiated.</span></p><p class="c3"><span class="c0">Argument is the target pitch value.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneMove_Sweep_Started</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">ushort</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent when a sweep is initiated.</span></p><p class="c3"><span class="c0">Argument is the target sweep value.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneMove_Sweep_Done</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">ushort</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent when a sweep move is complete.</span></p><p class="c3"><span class="c0">Argument is the current sweep value.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CranePickup</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">Null</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Request to initiate the pickup routine: send home, dip, magnetizing, lift, sweep to middle of playfield. Responds with Evt_CraneLoaded when successful, or Evt_CraneLoadFailed upon error.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CranePitchHome</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">ushort</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent when the pitch is in its home position or its pickup position. Argument is the current pitch value.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CranePitchMoveTo</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">4 options</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Request the crane pitch to move to the target value. Argument is the target pitch and an optional duration.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CranePitchMoveToPickup</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">double</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Lower the crane to pickup the ball.</span></p><p class="c3"><span class="c0">The argument is the move duration.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CranePitchSendHome</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">double</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Raise the crane to &ldquo;Crane Pitch Max&rdquo; height.</span></p><p class="c3"><span class="c0">The argument is the move duration.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneSendHome</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">null</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Request to move the crane to the home position.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneSendHomeWhenStepperDone</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">true</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Internal event sent during the send home routine when the extension reaches home, it signals the sweep and pitch home can start.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneStepperIsHome</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">null</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent when the crane extension is in its home position.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneSweepHome</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">ushort</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent when the crane sweep is in its home position. Argument is the current sweep value.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneSweepMoveTo</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">4 options</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Request the crane sweep to move to the target value. Argument is the target sweep and an optional duration.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CraneSweepMoveToPickup</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">null</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Sweep the crane to the home position.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CurrentCraneExtension</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">float</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent at regular intervals during an extension.</span></p><p class="c3"><span class="c0">The argument is the current extension percentage.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CurrentCranePitch</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">float</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent at regular intervals during a pitch.</span></p><p class="c3"><span class="c0">Argument is the current pitch percentage.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CurrentCraneSweep</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">float</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent at regular intervals during a sweep.</span></p><p class="c3"><span class="c0">Argument is the current sweep percentage.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_ServoParked_cranePitch</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">null</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status even sent when the pitch servo goes into idle mode.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_ServoParked_craneRotation</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">null</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent when the sweep servo goes into idle mode.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_SimulationWaitingForBallOffCrane</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">true</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Internal message sent during the drop routine when running in the simulator. It sends the necessary events to trick the application to think the ball has dropped off the crane.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c26" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_SimulationWaitingForBallOnCrane</span></p></td><td class="c20" colspan="1" rowspan="1"><p class="c3"><span class="c0">true</span></p></td><td class="c40" colspan="1" rowspan="1"><p class="c3"><span class="c0">Internal message sent during the pickup routine when running in the simulator. It sends the necessary events to trick the application to think the ball has been picked up by the crane.</span></p></td></tr></table><p class="c33 c25"><span class="c0"></span></p><p class="c33"><span class="c0">The 4 options are:</span></p><ul class="c56 lst-kix_list_3-0"><li class="c5 c9 c17 li-bullet-0"><span class="c0">ushort</span></li><li class="c5 c9 c17 li-bullet-0"><span class="c0">float between 0 and 1 as the percentage between the low and high values</span></li><li class="c5 c9 c17 li-bullet-0"><span class="c0">KeyValuePair&lt;ushort, double&gt; as the ushort coordinate and the move duration</span></li><li class="c7 c10 c17 li-bullet-0"><span class="c0">KeyValuePair&lt;float, double&gt; as the float percentage and the move duration. This is the recommended way.</span></li></ul><p class="c7 c25"><span class="c1"></span></p><p class="c7 c25"><span class="c1"></span></p><p class="c33"><span class="c0">The following table lists the Mode to GUI events related to the crane.</span></p><a id="t.389079967e5d6dbb119c5f18173c5a3af3105347"></a><a id="t.4"></a><table class="c51"><tr class="c18"><td class="c8 c38" colspan="1" rowspan="1"><p class="c3 c25"><span class="c0"></span></p></td><td class="c49 c38" colspan="1" rowspan="1"><p class="c3"><span class="c0">Event Name</span></p></td><td class="c16 c38" colspan="1" rowspan="1"><p class="c3"><span class="c0">Argument</span></p></td><td class="c43 c38" colspan="1" rowspan="1"><p class="c3"><span class="c0">Description</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c49" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_BallOffCrane</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c3"><span class="c0">true</span></p></td><td class="c43" colspan="1" rowspan="1"><p class="c3"><span class="c0">The magnet switch deactivated.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c49" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_BallOnCrane</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c3"><span class="c0">true</span></p></td><td class="c43" colspan="1" rowspan="1"><p class="c3"><span class="c0">The magnet switch activated.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c49" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CurrentCraneExtension</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c3"><span class="c0">float</span></p></td><td class="c43" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent to the GUI at regular intervals during an extension.</span></p><p class="c3"><span class="c0">The argument is the current extension percentage.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c49" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CurrentCranePitch</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c3"><span class="c0">float</span></p></td><td class="c43" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent to the GUI at regular intervals during a pitch.</span></p><p class="c3"><span class="c0">The argument is the current pitch percentage.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c49" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_CurrentCraneSweep</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c3"><span class="c0">float</span></p></td><td class="c43" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent to the GUI at regular intervals during a sweep.</span></p><p class="c3"><span class="c0">The argument is the current sweep percentage.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c49" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_TextCraneMechLog</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c3"><span class="c0">string</span></p></td><td class="c43" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event containing the last 10 log messages logged by the crane mech. The application can show the log messages on the screen for debugging.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c49" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_TextDriverExtension</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c3"><span class="c0">string</span></p></td><td class="c43" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent to the GUI at regular intervals during an extension. The argument is the current ushort extension as a string.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c49" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_TextDriverPitch</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c3"><span class="c0">string</span></p></td><td class="c43" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent to the GUI at regular intervals during a pitch. The argument is the current ushort pitch value as a string.</span></p></td></tr><tr class="c18"><td class="c8" colspan="1" rowspan="1"><p class="c3"><span class="c0">*</span></p></td><td class="c49" colspan="1" rowspan="1"><p class="c3"><span class="c0">Evt_TextDriverSweep</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c3"><span class="c0">string</span></p></td><td class="c43" colspan="1" rowspan="1"><p class="c3"><span class="c0">Status event sent to the GUI at regular intervals during a sweep. The argument is the current ushort sweep value as a string</span></p></td></tr></table><p class="c33 c25"><span class="c0"></span></p><p class="c7 c25"><span class="c0"></span></p></body></html>
