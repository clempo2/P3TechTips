<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=fpjTOVmNbO4Lz34iLyptLROjXfSpIU_1TsQlCJ7q4WlXEixY9aqhie8CVYCrTb1E);.lst-kix_list_2-1>li{counter-increment:lst-ctn-kix_list_2-1}ul.lst-kix_list_1-0{list-style-type:none}ol.lst-kix_list_2-6.start{counter-reset:lst-ctn-kix_list_2-6 0}.lst-kix_list_3-0>li:before{content:"-  "}ul.lst-kix_list_5-7{list-style-type:none}ul.lst-kix_list_5-8{list-style-type:none}.lst-kix_list_3-1>li:before{content:"\0025cf   "}.lst-kix_list_3-2>li:before{content:"\0025aa   "}ul.lst-kix_list_5-5{list-style-type:none}ul.lst-kix_list_5-6{list-style-type:none}ol.lst-kix_list_2-3.start{counter-reset:lst-ctn-kix_list_2-3 0}ul.lst-kix_list_1-3{list-style-type:none}.lst-kix_list_3-5>li:before{content:"\0025aa   "}ul.lst-kix_list_5-0{list-style-type:none}ul.lst-kix_list_1-4{list-style-type:none}ul.lst-kix_list_1-1{list-style-type:none}.lst-kix_list_3-4>li:before{content:"o  "}ul.lst-kix_list_1-2{list-style-type:none}ul.lst-kix_list_5-3{list-style-type:none}ul.lst-kix_list_1-7{list-style-type:none}.lst-kix_list_3-3>li:before{content:"\0025cf   "}ul.lst-kix_list_5-4{list-style-type:none}ul.lst-kix_list_1-8{list-style-type:none}ul.lst-kix_list_5-1{list-style-type:none}ul.lst-kix_list_1-5{list-style-type:none}ul.lst-kix_list_5-2{list-style-type:none}ul.lst-kix_list_1-6{list-style-type:none}.lst-kix_list_3-8>li:before{content:"\0025aa   "}.lst-kix_list_2-0>li{counter-increment:lst-ctn-kix_list_2-0}.lst-kix_list_2-3>li{counter-increment:lst-ctn-kix_list_2-3}.lst-kix_list_3-6>li:before{content:"\0025cf   "}.lst-kix_list_3-7>li:before{content:"o  "}ol.lst-kix_list_2-2{list-style-type:none}ol.lst-kix_list_2-3{list-style-type:none}.lst-kix_list_5-0>li:before{content:"\0025cf   "}ol.lst-kix_list_2-4{list-style-type:none}ol.lst-kix_list_2-5{list-style-type:none}ol.lst-kix_list_2-0{list-style-type:none}ol.lst-kix_list_2-1{list-style-type:none}.lst-kix_list_4-8>li:before{content:"\0025aa   "}.lst-kix_list_5-3>li:before{content:"\0025aa   "}.lst-kix_list_4-7>li:before{content:"o  "}.lst-kix_list_5-2>li:before{content:"\0025aa   "}.lst-kix_list_5-1>li:before{content:"o  "}ul.lst-kix_list_4-8{list-style-type:none}.lst-kix_list_5-7>li:before{content:"\0025aa   "}ul.lst-kix_list_4-6{list-style-type:none}.lst-kix_list_5-6>li:before{content:"\0025aa   "}.lst-kix_list_5-8>li:before{content:"\0025aa   "}ul.lst-kix_list_4-7{list-style-type:none}ul.lst-kix_list_4-0{list-style-type:none}ul.lst-kix_list_4-1{list-style-type:none}.lst-kix_list_5-4>li:before{content:"\0025aa   "}ul.lst-kix_list_4-4{list-style-type:none}.lst-kix_list_5-5>li:before{content:"\0025aa   "}ol.lst-kix_list_2-6{list-style-type:none}ul.lst-kix_list_4-5{list-style-type:none}ol.lst-kix_list_2-7{list-style-type:none}ul.lst-kix_list_4-2{list-style-type:none}ol.lst-kix_list_2-8{list-style-type:none}ul.lst-kix_list_4-3{list-style-type:none}.lst-kix_list_2-5>li{counter-increment:lst-ctn-kix_list_2-5}.lst-kix_list_2-8>li{counter-increment:lst-ctn-kix_list_2-8}.lst-kix_list_2-2>li{counter-increment:lst-ctn-kix_list_2-2}ol.lst-kix_list_2-4.start{counter-reset:lst-ctn-kix_list_2-4 0}.lst-kix_list_2-6>li:before{content:"" counter(lst-ctn-kix_list_2-6,decimal) ". "}.lst-kix_list_2-7>li:before{content:"" counter(lst-ctn-kix_list_2-7,decimal) ". "}.lst-kix_list_2-7>li{counter-increment:lst-ctn-kix_list_2-7}.lst-kix_list_2-4>li:before{content:"" counter(lst-ctn-kix_list_2-4,decimal) ". "}.lst-kix_list_2-5>li:before{content:"" counter(lst-ctn-kix_list_2-5,decimal) ". "}.lst-kix_list_2-8>li:before{content:"" counter(lst-ctn-kix_list_2-8,decimal) ". "}ul.lst-kix_list_3-7{list-style-type:none}ul.lst-kix_list_3-8{list-style-type:none}ul.lst-kix_list_3-1{list-style-type:none}ul.lst-kix_list_3-2{list-style-type:none}ul.lst-kix_list_3-0{list-style-type:none}ul.lst-kix_list_3-5{list-style-type:none}ul.lst-kix_list_3-6{list-style-type:none}ul.lst-kix_list_3-3{list-style-type:none}ul.lst-kix_list_3-4{list-style-type:none}ol.lst-kix_list_2-5.start{counter-reset:lst-ctn-kix_list_2-5 0}.lst-kix_list_4-0>li:before{content:"-  "}.lst-kix_list_2-6>li{counter-increment:lst-ctn-kix_list_2-6}.lst-kix_list_4-1>li:before{content:"o  "}.lst-kix_list_4-4>li:before{content:"o  "}ol.lst-kix_list_2-2.start{counter-reset:lst-ctn-kix_list_2-2 0}.lst-kix_list_4-3>li:before{content:"\0025cf   "}.lst-kix_list_4-5>li:before{content:"\0025aa   "}.lst-kix_list_4-2>li:before{content:"\0025aa   "}.lst-kix_list_4-6>li:before{content:"\0025cf   "}.lst-kix_list_2-4>li{counter-increment:lst-ctn-kix_list_2-4}ol.lst-kix_list_2-8.start{counter-reset:lst-ctn-kix_list_2-8 0}.lst-kix_list_1-0>li:before{content:"-  "}.lst-kix_list_1-1>li:before{content:"o  "}.lst-kix_list_1-2>li:before{content:"\0025aa   "}ol.lst-kix_list_2-0.start{counter-reset:lst-ctn-kix_list_2-0 0}.lst-kix_list_1-3>li:before{content:"\0025cf   "}.lst-kix_list_1-4>li:before{content:"o  "}.lst-kix_list_1-7>li:before{content:"o  "}ol.lst-kix_list_2-7.start{counter-reset:lst-ctn-kix_list_2-7 0}.lst-kix_list_1-5>li:before{content:"\0025aa   "}.lst-kix_list_1-6>li:before{content:"\0025cf   "}.lst-kix_list_2-0>li:before{content:"" counter(lst-ctn-kix_list_2-0,decimal) ". "}.lst-kix_list_2-1>li:before{content:"" counter(lst-ctn-kix_list_2-1,decimal) ". "}ol.lst-kix_list_2-1.start{counter-reset:lst-ctn-kix_list_2-1 0}.lst-kix_list_1-8>li:before{content:"\0025aa   "}.lst-kix_list_2-2>li:before{content:"" counter(lst-ctn-kix_list_2-2,decimal) ". "}.lst-kix_list_2-3>li:before{content:"" counter(lst-ctn-kix_list_2-3,decimal) ". "}ol{margin:0;padding:0}table td,table th{padding:0}.c7{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;background-color:#e7e6e6;border-left-style:solid;border-bottom-width:1pt;width:142.4pt;border-top-color:#000000;border-bottom-style:solid}.c33{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:180.4pt;border-top-color:#000000;border-bottom-style:solid}.c11{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:141.2pt;border-top-color:#000000;border-bottom-style:solid}.c9{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:40.4pt;border-top-color:#000000;border-bottom-style:solid}.c29{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:142.4pt;border-top-color:#000000;border-bottom-style:solid}.c34{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:715.6pt;border-top-color:#000000;border-bottom-style:solid}.c1{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:719.5pt;border-top-color:#000000;border-bottom-style:solid}.c30{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:338.2pt;border-top-color:#000000;border-bottom-style:solid}.c6{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:184.1pt;border-top-color:#000000;border-bottom-style:solid}.c27{border-right-style:solid;padding:0pt 5.4pt 0pt 5.4pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:335.8pt;border-top-color:#000000;border-bottom-style:solid}.c37{padding-top:12pt;padding-bottom:0pt;line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c12{padding-top:12pt;padding-bottom:12pt;line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c38{color:#2f5496;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Calibri";font-style:normal}.c3{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Calibri";font-style:normal}.c35{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:8.5pt;font-family:"Consolas";font-style:normal}.c13{color:#2f5496;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:13pt;font-family:"Calibri";font-style:normal}.c25{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Consolas";font-style:normal}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9.5pt;font-family:"Consolas";font-style:normal}.c19{padding-top:0pt;padding-bottom:6pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c31{padding-top:12pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c5{padding-top:12pt;padding-bottom:8pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c23{padding-top:6pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c8{padding-top:0pt;padding-bottom:8pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c18{padding-top:0pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c10{padding-top:6pt;padding-bottom:6pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c20{padding-top:0pt;padding-bottom:0pt;line-height:1.0791666666666666;orphans:2;widows:2;text-align:left}.c14{font-size:9.5pt;font-family:"Consolas";color:#000000;font-weight:400}.c15{border-spacing:0;border-collapse:collapse;margin-right:auto}.c16{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#0563c1;text-decoration:underline}.c36{margin-left:-5.7pt;border-spacing:0;border-collapse:collapse;margin-right:auto}.c28{font-size:9.5pt;font-family:"Consolas";color:#0000ff;font-weight:400}.c17{background-color:#ffffff;max-width:720pt;padding:36pt 36pt 36pt 36pt}.c39{font-size:9.5pt;font-family:"Consolas";font-weight:400}.c22{margin-left:36pt;height:11pt}.c26{background-color:#e7e6e6}.c24{height:11pt}.c21{text-indent:36pt}.c4{vertical-align:super}.c32{height:52.5pt}.c0{height:0pt}.title{padding-top:24pt;color:#000000;font-weight:700;font-size:36pt;padding-bottom:6pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:18pt;color:#666666;font-size:24pt;padding-bottom:4pt;font-family:"Georgia";line-height:1.0791666666666666;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Calibri"}p{margin:0;color:#000000;font-size:11pt;font-family:"Calibri"}h1{padding-top:12pt;color:#2f5496;font-size:16pt;padding-bottom:0pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:2pt;color:#2f5496;font-size:13pt;padding-bottom:0pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:0pt;color:#000000;font-weight:700;font-size:13.5pt;padding-bottom:8pt;font-family:"Times New Roman";line-height:1.0;orphans:2;widows:2;text-align:left}h4{padding-top:12pt;color:#000000;font-weight:700;font-size:12pt;padding-bottom:2pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:11pt;color:#000000;font-weight:700;font-size:11pt;padding-bottom:2pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:10pt;color:#000000;font-weight:700;font-size:10pt;padding-bottom:2pt;font-family:"Calibri";line-height:1.0791666666666666;page-break-after:avoid;orphans:2;widows:2;text-align:left}</style></head><body class="c17 doc-content"><h1 class="c37"><span class="c38">Ball Saver</span></h1><p class="c5"><span class="c3">In this P3TechTip, we will look at how the ball saver works.</span></p><p class="c8"><span>The ball saver functionality is mainly implemented by the BallSaveMode. There is a short overview of BallSaveMode in </span><span class="c16">file:///C:/P3/P3_SDK_V0.8/P3SampleApp/Documentation/html/_mode_layer.html#IncludedModes</span><span class="c3">&nbsp;</span></p><p class="c20"><span>The BallSaveMode class is documented in </span><span class="c16">file:///C:/P3/P3_SDK_V0.8/P3SampleApp/Documentation/html/class_multimorphic_1_1_p3_app_1_1_modes_1_1_ball_save_mode.html</span></p><p class="c5"><span class="c3">RespawnMode is similar to a ball saver. This mode will also be covered.</span></p><p class="c5"><span class="c3">The source code of BallSaveMode is not available, but RespawnMode and a lot of supporting code is open source in P3SampleApp.</span></p><h2 class="c12"><span class="c13">Overview</span></h2><p class="c8"><span class="c3">When the ball saver is active, a ball that drains is relaunched. The ball saver counts down a timer which is displayed on the screen. When the displayed count reaches 0, it is erased from the screen but the timer continues internally for the grace period. When the grace period expires, the ball saver is automatically deactivated. There is no limit on the number of balls that can be saved during one activation. If the ball saver must end after saving only one ball, the application must stop the ball saver explicitly.</span></p><h2 class="c12"><span class="c13">Ball Saver Settings</span></h2><p class="c8"><span class="c3">P3SampleApp has 2 settings to control the ball saver: BallSaveTime and BallSaveGracePeriod. </span></p><p class="c8"><span class="c3">The two settings are declared in P3SASettingsMode:</span></p><a id="t.f4b495d36d693b8d6a09d346004f1e8cf962c130"></a><a id="t.0"></a><table class="c15"><tr class="c0"><td class="c1" colspan="1" rowspan="1"><p class="c31"><span class="c25">InitAttr(37, &quot;BallSaveTime&quot;, &quot;Ball Save Time&quot;, &quot;Ball Save Time&quot;, &quot;Service Menu/Settings/Gameplay/General&quot;, PRW, 15, 0, 20, 1, 15);</span></p><p class="c18"><span class="c25">InitAttr(37, &quot;BallSaveGracePeriod&quot;, &quot;Ball Save grace period time&quot;, &quot;Ball Save grace period time&quot;, &quot;Service Menu/Settings/Gameplay/General&quot;,</span></p><p class="c18 c21"><span class="c25">PRW, 3, 0, 5, 1, 3);</span></p><p class="c18 c24"><span class="c25"></span></p></td></tr></table><p class="c18 c24"><span class="c25"></span></p><p class="c8"><span class="c3">Both settings are accessible from the service menu at this path: Service Menu/Settings/Gameplay/General.</span></p><p class="c8"><span class="c3">The PRW option means the settings can be edited by the user (read-write) and it can be part of a player profile, hence they can differ per player when using profiles.</span></p><p class="c8"><span class="c3">BallSaveTime can range from 0 to 20 in 1 increment and the default is 15 seconds. This includes the grace period (unless the value is too small).</span></p><p class="c8"><span class="c3">BallSaveGracePeriod can range from 0 to 5 in 1 increment and the default is 3 seconds.</span></p><p class="c8"><span class="c3">The application is responsible to deal with the BallSaveTime settings as seen in HomeMode. The SDK deals with BallSaveGracePeriod automatically in BallSaveMode.</span></p><p class="c8"><span class="c3">Applications can define more ball saver settings for specific contexts. P3SampleApp shows how to do this in Modes/GameModes/Multiball.cs with the MultiballBallSaveTime settings (though this code is unreachable because the Multiball mode is commented out in HomeMode).</span></p><h2 class="c12"><span class="c13">BallSaveMode</span></h2><p class="c8"><span class="c3">The class documentation for BallSaveMode is very terse, but we can infer a lot from the method names. We see the mode responds to 8 events through 8 event handlers. The callers do not call methods directly, they send events and the mode responds to them.</span></p><p class="c8"><span class="c3">The following table lists the events handled by BallSaveMode:</span></p><a id="t.920bdfa33a10feead0241e98cf695586f7bf315f"></a><a id="t.1"></a><table class="c15"><tr class="c32"><td class="c6 c26" colspan="1" rowspan="1"><p class="c10"><span class="c3">Event Name</span></p></td><td class="c9 c26" colspan="1" rowspan="1"><p class="c10"><span class="c3">Event Object Type </span></p></td><td class="c11 c26" colspan="1" rowspan="1"><p class="c10"><span class="c3">Event Object Description</span></p></td><td class="c27 c26" colspan="1" rowspan="1"><p class="c10"><span class="c3">Event Description</span></p></td></tr><tr class="c0"><td class="c6" colspan="1" rowspan="1"><p class="c10"><span class="c3">Evt_BallSaveStart</span></p></td><td class="c9" colspan="1" rowspan="1"><p class="c10"><span class="c3">int</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c10"><span class="c3">ball saver timer inclusive of the grace period</span></p></td><td class="c27" colspan="1" rowspan="1"><p class="c10"><span class="c3">Sets the timer and starts the ball saver if not already running. The grace period is included in the value but will be added to the timer if the timer is shorter than the grace period.</span></p></td></tr><tr class="c0"><td class="c6" colspan="1" rowspan="1"><p class="c10"><span class="c3">Evt_BallSaveAdd</span></p></td><td class="c9" colspan="1" rowspan="1"><p class="c10"><span class="c3">int</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c10"><span class="c3">Time to add to the ball saver timer</span></p></td><td class="c27" colspan="1" rowspan="1"><p class="c10"><span class="c3">If the ball saver is already running, the time is added to the timer. If the ball saver is stopped or in the grace period, the ball saver is started with that time instead.</span></p></td></tr><tr class="c0"><td class="c6" colspan="1" rowspan="1"><p class="c10"><span class="c3">Evt_BallSavePause</span></p></td><td class="c9" colspan="1" rowspan="1"><p class="c10"><span class="c3">Any</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c10"><span class="c3">Not used.</span></p></td><td class="c27" colspan="1" rowspan="1"><p class="c10"><span class="c3">Pauses the ball saver timer until it is started, added or resumed. Drained balls are no longer saved. The next Evt_BallSaveStatus event is sent with event object 0 to instruct the UI to erase the ball saver counter from the screen.</span></p></td></tr><tr class="c0"><td class="c6" colspan="1" rowspan="1"><p class="c10"><span class="c3">Evt_BallSaveResume</span></p></td><td class="c9" colspan="1" rowspan="1"><p class="c10"><span class="c3">Any</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c10"><span class="c3">Not used.</span></p></td><td class="c27" colspan="1" rowspan="1"><p class="c10"><span class="c3">Resumes the ball saver timer countdown from where it was paused, though it might remain paused until a grid event if that option is active.</span></p></td></tr><tr class="c0"><td class="c6" colspan="1" rowspan="1"><p class="c10"><span class="c3">Evt_BallSaveStop</span></p></td><td class="c9" colspan="1" rowspan="1"><p class="c10"><span class="c3">Any</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c10"><span class="c3">Not used.</span></p></td><td class="c27" colspan="1" rowspan="1"><p class="c10"><span class="c3">Sets the timer to 0, and therefore balls will no longer be saved. Evt_BallSaveStatus is sent with event object value equal to &ldquo;minus the grace period, to instruct the UI to erase the ball saver counter from the screen.</span></p></td></tr><tr class="c0"><td class="c6" colspan="1" rowspan="1"><p class="c10"><span class="c3">Evt_BallSavePauseUntilGrid</span></p></td><td class="c9" colspan="1" rowspan="1"><p class="c10"><span class="c3">Any</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c10"><span class="c3">Not used.</span></p></td><td class="c27" colspan="1" rowspan="1"><p class="c10"><span class="c3">Pauses the ball saver timer until a grid event (i.e. until a ball is detected on the screen), though it might remain paused if currently paused by Evt_BallSavePause.</span></p><p class="c10"><span class="c3">The countdown will resume no matter what if the ball saver is started again (either through a start or an add that causes a start).</span></p></td></tr><tr class="c0"><td class="c6" colspan="1" rowspan="1"><p class="c10"><span class="c3">Evt_BallSaveGetActualTimeRemaining</span></p></td><td class="c9" colspan="1" rowspan="1"><p class="c10"><span class="c3">Any</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c10"><span class="c3">Not used.</span></p></td><td class="c27" colspan="1" rowspan="1"><p class="c10"><span class="c3">Responds by sending Evt_BallSaveActualTimeRemaining with an int event object equal to the timer. This is how you can query for the remaining time including the grace period. The value returned should be non-negative.</span></p></td></tr><tr class="c0"><td class="c6" colspan="1" rowspan="1"><p class="c10"><span class="c3">Evt_BallSaveGetDisplayTimeRemaining</span></p></td><td class="c9" colspan="1" rowspan="1"><p class="c10"><span class="c3">Any</span></p></td><td class="c11" colspan="1" rowspan="1"><p class="c10"><span class="c3">Not used.</span></p></td><td class="c27" colspan="1" rowspan="1"><p class="c10"><span class="c3">Responds by sending Evt_BallSaveDisplayTimeRemaining with an int event object equal to the timer minus the grace period. This is how you programmatically query for the remaining time to display on the screen, though handling Evt_BallSaveStatus is more common. The value returned can be negative if the grace period is greater than 0.</span></p></td></tr></table><p class="c8 c24"><span class="c3"></span></p><p class="c8"><span class="c3">This code shows how to query for the actual time remaining from within a mode. The code to query for the display time remaining is similar.</span></p><a id="t.00067f14508dc6cc37fac28bea2dbc32dfff9ebb"></a><a id="t.2"></a><table class="c15"><tr class="c0"><td class="c1" colspan="1" rowspan="1"><p class="c23"><span class="c2">AddModeEventHandler(&quot;Evt_BallSaveActualTimeRemaining&quot;, BallSaveActualTimeRemainingEventHandler, Priority);</span></p><p class="c18"><span class="c2">&hellip;</span></p><p class="c18"><span class="c14">PostModeEventToModes</span><span class="c2">(&quot;Evt_BallSaveGetActualTimeRemaining&quot;, 0);</span></p><p class="c18"><span class="c2">&hellip;</span></p><p class="c18"><span class="c28">private</span><span class="c14">&nbsp;</span><span class="c28">bool</span><span class="c14">&nbsp;</span><span class="c39">BallSaveActualTimeRemainingEventHandler</span><span class="c14">&nbsp;(</span><span class="c28">string</span><span class="c14">&nbsp;evtName, </span><span class="c28">object</span><span class="c2">&nbsp;evtData)</span></p><p class="c18"><span class="c2">{</span></p><p class="c18"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int timeRemaining = (int)evtData;</span></p><p class="c18"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&hellip;</span></p><p class="c18"><span class="c14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c28">return</span><span class="c2">&nbsp;EVENT_STOP;</span></p><p class="c19"><span class="c14">}</span></p></td></tr></table><p class="c8 c24"><span class="c2"></span></p><p class="c8"><span class="c3">Every second when the timer is greater than 0 and the ball saver is not paused, the mode decrements the timer by 1 and sends the Evt_BallSaveStatus event. The event object is the display time remaining, i.e. timer minus the grace period. When the event object is 0, the UI should erase visible traces of the ball saver. The ball saver will continue to be active during the grace period and send Evt_BallSaveStatus with negative values. There is no special event to indicate the ball saver finally stopped.</span></p><p class="c8"><span class="c3">When a ball drains and the timer is active and not paused, the mode sends the Evt_BallSaved event and blocks the drain switch event to reach other modes. The event object is not used with Evt_BallSaved. It is worth repeating the ball will drain when the ball saver is paused. Notice BallSaveMode does not trigger BallLauncherMode directly as the SDK Guide suggests. More precisely, the ball launch occurs in SceneMode when it handles the Evt_BallSaved event. SceneMode is the base class of HomeMode.</span></p><h2 class="c12"><span class="c13">HomeMode</span></h2><p class="c8"><span class="c3">HomeMode is where the BallSaveMode is created. HomeMode adds the BallSaveMode to the ModeQueue when StartPlaying() is called, and removes the BallSaveMode when HomeMode stops.</span></p><p class="c8"><span class="c3">Adding BallSaveMode to the ModeQueue does not activate the ball saver timer. It simply causes BallSaveMode to start listening for events.</span></p><p class="c8"><span class="c3">We are ignoring the code that starts the ball saver in StartPlaying() when instructionsLaunch is enabled because the use of InstructionMode is not fully coded in P3SampleApp.</span></p><p class="c8"><span class="c3">More typically, HomeMode starts the ball saver when it handles the Evt_BallStartComplete event:</span></p><a id="t.49b6ddce77c980f8f59ceb9ef46676cca1fed44a"></a><a id="t.3"></a><table class="c36"><tr class="c0"><td class="c1" colspan="1" rowspan="1"><p class="c23"><span class="c2">int ballSaveTime = (data.GetGameAttributeValue(&quot;BallSaveTime&quot;).ToInt());</span></p><p class="c18"><span class="c2">PostModeEventToModes (&quot;Evt_BallSaveStart&quot;, ballSaveTime);</span></p><p class="c19"><span class="c2">PostModeEventToModes (&quot;Evt_BallSavePauseUntilGrid&quot;, 0);</span></p></td></tr></table><p class="c5"><span class="c3">Evt_BallSavePauseUntilGrid ignores its event object, so passing 0 actually enables the pause until the grid event occurs.</span></p><p class="c5"><span class="c3">There is more ball saver functionality in SceneMode, which is the base class of HomeMode. This could potentially affect any scene mode, but since HomeMode is the only mode in P3SampleApp that adds BallSaveMode to the ModeQueue, the code is really only applicable to HomeMode.</span></p><p class="c5"><span class="c3">When SceneMode starts, it pauses any previously running ball saver by sending Evt_BallSavePause. The event object 0 is ignored.</span></p><a id="t.dbf1df660dd701b6565f2080935c05fa0e8adf8c"></a><a id="t.4"></a><table class="c15"><tr class="c0"><td class="c1" colspan="1" rowspan="1"><p class="c23"><span class="c2">// Pause any previously running Ball Save</span></p><p class="c19"><span class="c2">PostModeEventToModes (&quot;Evt_BallSavePause&quot;, 0);</span></p></td></tr></table><p class="c5"><span class="c3">When SceneMode receives a Evt_BallSaved event, it launches a new ball and possibly sends an event to show a ball saved animation. The Evt_BallSaved event is stopped so no other mode can handle it. The ball saved animation is discussed in the next section.</span></p><a id="t.0348a57cf3b13c36d6e6206d53cfe8c2b6b8c822"></a><a id="t.5"></a><table class="c15"><tr class="c0"><td class="c1" colspan="1" rowspan="1"><p class="c23"><span class="c2">protected virtual bool BallSavedEventHandler(string evtName, object evtData)</span></p><p class="c18"><span class="c2">{</span></p><p class="c18"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P3SABallLauncher.delayed_launch(2.25);</span></p><p class="c18"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (showBallSaved)</span></p><p class="c18"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PostModeEventToGUI(&quot;Evt_BallSavePlayAnimation&quot;, sceneName);</span></p><p class="c18"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return SWITCH_STOP;</span></p><p class="c19"><span class="c2">}</span></p></td></tr></table><p class="c8 c21 c22"><span class="c2"></span></p><h2 class="c12"><span class="c13">BallSaveManager</span></h2><p class="c8"><span class="c3">So far, we looked at what happens on the mode thread. Let&rsquo;s switch to see what happens on the GUI thread.</span></p><p class="c8"><span class="c3">The P3SASceneController creates a BallSaveManager component to handle the UI for the ball saver. The BallSaveManager remains active for as long as the scene is active. The BallSaveManager source code is open source in P3SampleApp.</span></p><p class="c8"><span class="c3">P3SASceneController is the base class of every scene controllers in P3SampleApp. Since only HomeMode creates a BallSaveMode, only the Home scene will be affected by the ball saver. The BallSaveManager in the Attract scene will stay hidden and dormant.</span></p><p class="c8"><span class="c3">When the ball saver is active, BallSaveMode sends the Evt_BallSaveStatus event every second to tell the UI to update the counter on the screen. The event object is an int and its value is the display time remaining. If the value is greater than 0, it means the ball saver is active and its UI should be shown. If the value is 0, it means the ball saver UI should be removed, though the ball saver will continue to run for the remaining of the grace period. If the value is less than 0, it means the ball saver is running within the grace period and nothing special needs to be shown.</span></p><p class="c8"><span class="c3">By default, the BallSaveTime is 15 and the BallSaveGracePeriod is 3. If the ball saver runs to completion, this will send 16 Evt_BallSaveStatus events with these event objects: 12, 11, &hellip;, 1, 0, -1, -2, -3. If the ball saver is stopped by the application after 3 seconds, this will send these Evt_BallSaveStatus events: 12, 11, 10, 9, -3, -4. The important thing to notice is 0 is not sent, and the status jumps directly to negative the grace period. This is followed by an additional event which I consider a minor bug in the SDK. This should not affect the UI since the ball saver was erased from the screen when the -3 event was handled.</span></p><p class="c8"><span class="c3">If there is no grace period, running the ball saver to completion will send these Evt_BallSaveStatus events: 15, 14, &hellip;, 0. If the ball saver is stopped after 3 seconds, this will send these events: 15, 14, 13, 12, 0, -1. The -1 event is the same minor bug. It should not affect the UI because the ball saver was erased from the screen when the 0 event was handled.</span></p><p class="c8"><span class="c3">If BallSaveManager detects the ball saver is newly active, it instantiates the InvincibilityActive prefab. This prefab contains the whole UI for the ball saver. It consists of: a force field dome over the flippers, some text fields and a point light. The text fields show the counter value, together they make a nice visual effect.</span></p><p class="c8"><span class="c3">The BallSaveManager tries to linear interpolate the alpha of the dome but that code has no effect as it stands. In Unity, it is not possible to change the alpha of a Color without recreating the whole Color object.</span></p><p class="c8"><span class="c3">Removing the ball saver UI is as simple as destroying the prefab instance. BallSaveManager also plays the sound BallSaveDisabled but that sound resource is missing in P3SampleApp. In practice, no sound is played and the game continues unaffected.</span></p><p class="c8"><span class="c3">Modes can enable or disable the animation that is played when a ball is saved by sending the Evt_EnableBallSavedFeedback. The event object is a bool where true means enable and false means disable. For example, Multiball mode sends the Evt_EnableBallSavedFeedback event to disable the ball saved animation when multiball is active. That code is never executed though, because Multiball is commented out in HomeMode. By default, the animation is enabled, and it will remain enabled whenever balls are playing in P3SampleApp because no other mode sends Evt_EnableBallSavedFeedback.</span></p><p class="c8"><span class="c3">When SceneMode receives the Evt_BallSaved from BallSaveMode and ball saved animation is enabled, it sends the Evt_BallSavePlayAnimation event. The event object is the scene name. When BallSaveManager receives the Evt_ BallSavePlayAnimation event, it plays the Ball_Save_&lt;sceneName&gt; sound. This sound resource is also missing in P3SampleApp. Again, no sound is played and the game continues. The animation is played by instantiating the Prefabs/&lt;sceneName&gt;/BallSave prefab. In P3SampleApp, that will always be Prefabs/Home/BallSave.prefab</span></p><p class="c8"><span class="c3">Prefabs/Home/BallSave.prefab consists of a chrome ball and its halo, a tractor beam and a text field showing BALL SAVED.</span></p><p class="c8"><span class="c3">The fastest way to see the ball saved animation in the simulator is to: open P3SampleApp in Unity, select the Bootstrap scene, hit the play button, press s to start the game, press l (lowercase L) to launch a ball, and press 0 (zero) to drain the ball.</span></p><p class="c8"><span class="c3">The prefabs are just examples. Your application can implement whatever UI it wants in combination with new code in BallSaveManager.</span></p><h2 class="c12"><span class="c13">RespawnMode</span></h2><p class="c8"><span class="c3">RespawnMode is a virtual kickback for balls that drain below the lower flippers. Unlike a typical ball saver, there is no countdown timer.</span></p><p class="c8"><span class="c3">RespawnMode keeps a count of how many drained balls it can relaunch. The application controls when to increment the count. In P3SampleApp, the count is incremented when the player earns a Respawn award. When a ball drains and RespawnMode is enabled and the count is greater than 0, the count is decremented and the ball is relaunched. </span></p><p class="c8"><span class="c3">There are no settings in P3SampleApp that affect this mode.</span></p><p class="c8"><span class="c3">The following table lists the events handled by RespawnMode:</span></p><a id="t.7b426925fad23d025aba664e16bed7ea17c25a96"></a><a id="t.6"></a><table class="c15"><tr class="c32"><td class="c26 c33" colspan="1" rowspan="1"><p class="c10"><span class="c3">Event Name</span></p></td><td class="c9 c26" colspan="1" rowspan="1"><p class="c10"><span class="c3">Event Object Type </span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c10"><span class="c3">Event Object Description</span></p></td><td class="c30 c26" colspan="1" rowspan="1"><p class="c10"><span class="c3">Event Description</span></p></td></tr><tr class="c0"><td class="c33" colspan="1" rowspan="1"><p class="c10"><span class="c3">Evt_RespawnAdd</span></p></td><td class="c9" colspan="1" rowspan="1"><p class="c10"><span class="c3">int</span></p></td><td class="c29" colspan="1" rowspan="1"><p class="c10"><span class="c3">The number to add to the count.</span></p></td><td class="c30" colspan="1" rowspan="1"><p class="c10"><span class="c3">Adds a number to the count of drained balls that can be relaunched. If the number is negative, the count is reduced.</span></p></td></tr><tr class="c0"><td class="c33" colspan="1" rowspan="1"><p class="c10"><span class="c3">Evt_RespawnEnable</span></p></td><td class="c9" colspan="1" rowspan="1"><p class="c10"><span class="c3">bool</span></p></td><td class="c29" colspan="1" rowspan="1"><p class="c10"><span class="c3">true to enable, false to disable</span></p></td><td class="c30" colspan="1" rowspan="1"><p class="c10"><span class="c3">Enable RespawnMode if the event object is true. Disable RespawnMode if the event object is false.</span></p></td></tr></table><p class="c5"><span class="c3">The count starts at 0 whenever RespawnMode starts, therefore the respawn awards are lost when the ball ends in P3SampleApp. An application has to restore the count explicitly at the start of a ball if it wants to preserve the count.</span></p><p class="c8"><span class="c3">HomeMode is where the RespawnMode is created. HomeMode adds RespawnMode to the ModeQueue when StartPlaying() is called, and removes the RespawnMode when HomeMode stops.</span></p><p class="c8"><span class="c3">Multiball mode disables RespawnMode when multiball starts and enables RespawnMode when multiball ends. This code is unreachable since Multiball is commented out in HomeMode. Since HomeMode enables RespawnMode when it adds it to the queue and no other mode sends Evt_RespawnEnable, we know RespawnMode remains enabled whenever balls are playing in P3SampleApp.</span></p><p class="c8 c24"><span class="c3"></span></p><p class="c8"><span>In P3SampleApp, the player earns a Respawn award by achieving a certain number of lower lane completions. LanesMode is where this is implemented. Hitting all 4 targets over the inlanes and outlanes count for 1 completion. A Respawn award is given on the 10</span><span class="c4">th</span><span>, 20</span><span class="c4">th</span><span>, 40</span><span class="c4">th</span><span>, 100</span><span class="c4">th</span><span>&nbsp;and 1000</span><span class="c4">th</span><span class="c3">&nbsp;completions.</span></p><p class="c8"><span class="c3">RespawnMode does not relaunch the ball directly. Instead, it sends the Evt_BallSaved event, just like BallSaveMode does in the same situation.</span></p><p class="c8"><span class="c3">BallSaveMode has higher priority (75) than RespawnMode (74). If a ball drains and is saved by BallSaveMode, RespawnMode will never know because the drain switch event will be blocked before it reaches it.</span></p><p class="c8"><span class="c3">RespawnMode sends the Evt_RespawnStatus event whenever the count or the enable status changes. The event object is the new count. When disabled, the count in the status is forced to 0. BallSaveManager handles the Evt_RespawnStatus to display the RespawnMode UI. This is the same class that handles the BallSaveMode UI.</span></p><p class="c8"><span class="c3">The RespawnMode UI is created by instantiating the RespawnActive.prefab. On the screen, it shows RESPAWN ACTIVE with the count underneath. The fastest way to see this in the simulator is to complete the 4 lower lanes 10 times. An easier way for the impatient is to change the BonusX awards to Respawn awards in LanesMode and complete the 4 lanes once or twice.</span></p><a id="t.0ee200cac0f75fd221cf7f260db379c1ae527291"></a><a id="t.7"></a><table class="c15"><tr class="c0"><td class="c34" colspan="1" rowspan="1"><p class="c10"><span class="c35">private List&lt;string&gt; awards = new List&lt;string&gt;() {&quot;Respawn&quot;, &quot;Respawn&quot;, &quot;Respawn&quot;, &quot;Respawn&quot;, &quot;Respawn&quot;, &quot;Respawn&quot;, &quot;Respawn&quot;, &quot;Respawn&quot;, &quot;Respawn&quot;};</span></p></td></tr></table><p class="c5"><span class="c3">The UI of BallSaveMode takes precedence over the UI for RespawnMode. You must wait for the ball saver to end before you can see the RespawnMode UI.</span></p><h2 class="c12"><span class="c13">Unused Code</span></h2><p class="c8"><span>The class Multimorphic.P3App.GUI.BallSave is unused, though it is documented here </span><span class="c16">file:///C:/P3/P3_SDK_V0.8/P3SampleApp/Documentation/html/class_multimorphic_1_1_p3_app_1_1_g_u_i_1_1_ball_save.html</span><span class="c3">&nbsp;</span></p><p class="c8"><span class="c3">Assets/Resources/Prefabs/BallSaveActive.prefab is not used in P3SampleApp. The similar InvincibilityActive.prefab is used instead.</span></p><p class="c20"><span class="c3">Assets\Scripts\Modes\GameModes\Multiball.cs is not used in P3SampleApp because the Multiball mode is commented out in HomeMode.</span></p><p class="c8"><span class="c3">Multiball is an example of starting the ball saver during a mode, using an extra settings to specify the ball saver time, disabling the jackpot when a ball is saved, turning off the ball saved animation for the duration of the mode, and increasing the ball saver timer when it is already started.</span></p><p class="c8"><span class="c3">Scripts\Modes\GameModes\TargetSaveMode.cs is not used in P3SampleApp. This is another example showing how to start the ball saver during a mode.</span></p></body></html>